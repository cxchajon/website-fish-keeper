<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KTRVCMQN');</script>
  <!-- End Google Tag Manager -->
  <link rel="preload" href="/footer.html?v=1.5.2" as="fetch" crossorigin="anonymous">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO Meta Tags -->
  <title>Aquarium Journal - Real Tank Data & Maintenance Logs | The Tank Guide</title>
  <meta name="description" content="Follow real-time maintenance logs, water parameters, and weekly recaps from a 29-gallon planted community aquarium. December 2025: maintaining BBA-free status and celebrating 8 years of successful fishkeeping.">
  <meta name="keywords" content="aquarium journal, fish tank maintenance log, water parameters, planted tank care, aquarium weekly recap, fishkeeping journal">
  <meta name="author" content="The Tank Guide">
  <meta name="robots" content="index,follow" />

  <!-- Open Graph / Social -->
  <meta property="og:site_name" content="The Tank Guide" />
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://thetankguide.com/journal.html">
  <meta property="og:title" content="Aquarium Journal - Real Tank Data | The Tank Guide">
  <meta property="og:description" content="Follow real-time maintenance logs, water parameters, and weekly recaps from a 29-gallon planted community aquarium.">
  <meta property="og:image" content="https://thetankguide.com/assets/img/logos/logo-1200x630.png">
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="FishKeepingLifeCo logo (1200√ó630)." />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://thetankguide.com/journal.html">
  <meta name="twitter:title" content="Aquarium Journal - Real Tank Data | The Tank Guide">
  <meta name="twitter:description" content="Follow real-time maintenance logs, water parameters, and weekly recaps from a 29-gallon planted community aquarium.">
  <meta name="twitter:image" content="https://thetankguide.com/assets/img/logos/logo-1200x630.png">
  <meta name="twitter:image:alt" content="FishKeepingLifeCo logo (1200√ó630)." />

  <!-- Canonical URL -->
  <link rel="canonical" href="https://thetankguide.com/journal.html">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/favicon.png">

  <!-- Existing Site CSS -->
  <link rel="stylesheet" href="/css/app.bundle.css?v=2025-11-07">
  <link rel="stylesheet" href="/css/journal.css">

  <!-- Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Aquarium Journal - The Tank Guide",
    "description": "Real-time maintenance logs and weekly recaps from a 29-gallon planted community aquarium",
    "url": "https://thetankguide.com/journal.html",
    "publisher": { "@id": "https://thetankguide.com/#organization" },
    "mainEntity": {
      "@type": "ItemList",
      "itemListElement": [
        {
          "@type": "Article",
          "position": 1,
          "headline": "December 2025 - 29G Community Tank Journal",
          "datePublished": "2025-12-01",
          "dateModified": "2025-12-03",
          "description": "Maintaining BBA-free status after successful November treatment. Tank stability continues with 8-year-old fish showing the long-term success of proper care.",
          "author": {
            "@type": "Person",
            "name": "X"
          },
          "publisher": { "@id": "https://thetankguide.com/#organization" }
        }
      ]
    },
    "breadcrumb": {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://thetankguide.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Journal",
          "item": "https://thetankguide.com/journal.html"
        }
      ]
    }
  }
  </script>

  <script src="/js/nav.js?v=1.1.0" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Consent Mode defaults (runs after GA loader) -->
  <script src="/assets/js/consent-mode.js" defer></script>
  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token": "fef22cbf19e3473db5ec987a8f3bf4f3"}'></script>
  <!-- End Cloudflare Web Analytics -->
<!-- --- Google CMP (Funding Choices) START --- -->
  <script async src="https://fundingchoicesmessages.google.com/i/pub-9905718149811880?ers=1"></script>
  <script>
    // Required bootstrap per Google; signals CMP presence
    (function() {
      function signalGooglefcPresent() {
        if (!window.frames['googlefcPresent']) {
          if (document.body) {
            const iframe = document.createElement('iframe');
            iframe.style.cssText = 'display:none';
            iframe.name = 'googlefcPresent';
            document.body.appendChild(iframe);
          } else {
            setTimeout(signalGooglefcPresent, 0);
          }
        }
      }
      signalGooglefcPresent();
    })();
  </script>
  <!-- --- Google CMP (Funding Choices) END --- -->
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTRVCMQN"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div id="site-nav"></div>

  <main class="journal-main">

      <!-- Page Header -->
      <header class="journal-header" style="position: relative;">
          <h1>üê† Aquarium Journal</h1>
          <p class="journal-subtitle">Real-time maintenance logs from a 29-gallon planted community tank</p>

          <!-- Dashboard Discovery Icon -->
          <a href="/journal-dashboard.html"
             class="dashboard-icon"
             aria-label="View Parameter Dashboard"
             title="üìä Dashboard">
              üìä
          </a>
      </header>

      <!-- STICKY SECTION: Tank Status Dashboard -->
      <section id="tank-dashboard" class="dashboard-sticky">

          <div class="dashboard-grid">

              <!-- Current Parameters Card -->
              <div class="dashboard-card parameters-card"
                   data-current-nitrate="5"
                   data-test-date="2025-12-07"
                   data-tank-health="excellent"
                   data-next-water-change="2025-12-14">
                  <h2>üß™ Current Parameters</h2>
                  <ul class="param-list">
                      <li><strong>Nitrates:</strong> <span id="param-nitrates" class="param-value">5 ppm</span></li>
                      <li><strong>Last Test:</strong> <time id="param-last-test" datetime="2025-12-07">Dec 7, 2025</time></li>
                      <li><strong>Tank Health:</strong> <span id="param-tank-health" class="status-good">Excellent</span></li>
                      <li><strong>Next Water Change:</strong> <time id="param-next-water-change" datetime="2025-12-14">Dec 14, 2025</time></li>
                  </ul>
              </div>

              <!-- Feeding Routine Card -->
              <div class="dashboard-card feeding-card">
                  <h2>üçΩÔ∏è Feeding Routine</h2>
                  <p class="feeding-update">Last Updated: <time datetime="2025-11-15">Nov 15, 2025</time></p>
                  <table class="feeding-schedule">
                      <tbody>
                          <tr><td>Monday</td><td>Algae Wafers + Flakes</td></tr>
                          <tr><td>Tuesday</td><td>Brine Shrimp + Flakes</td></tr>
                          <tr><td>Wednesday</td><td>Algae Wafers + Flakes</td></tr>
                          <tr><td>Thursday</td><td>Bloodworms + Flakes</td></tr>
                          <tr><td>Friday</td><td>Algae Wafers + Flakes</td></tr>
                          <tr><td>Weekend</td><td>Light or optional flakes</td></tr>
                      </tbody>
                  </table>
              </div>

          </div>
      </section>

      <!-- Quick Navigation -->
      <nav class="month-nav" aria-label="Monthly navigation">
          <h2 class="sr-only">Jump to Month</h2>
          <ul class="month-nav-list">
              <li><a href="#december-2025" class="active">December 2025</a></li>
              <li><a href="#november-2025">November 2025</a></li>
              <li><a href="#october-2025">October 2025</a></li>
          </ul>
      </nav>

      <!-- DECEMBER 2025 SECTION -->
      <section id="december-2025" class="month-section">

          <header class="month-header">
              <h2>December 2025</h2>
              <p class="month-description">Maintaining BBA-free status and stable parameters. Weekly recaps begin after December 7th water change.</p>
          </header>

          <!-- Card Grid Container -->
          <div class="journal-grid">

              <!-- Weekly Maintenance & System Adjustment -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-28"
                       data-type="update"
                       data-category="maintenance"
                       data-focus="weekly-maintenance">
                  <div class="card-header">
                      <span class="card-icon">üîß</span>
                      <h3>Weekly Maintenance &amp; System Adjustment</h3>
                      <time datetime="2025-12-28">December 28, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Weekly maintenance routine with minor system adjustments:</p>
                      <ul>
                          <li>Performed a scheduled water change as part of ongoing system maintenance.</li>
                          <li>Pre‚Äìwater change nitrate levels measured approximately 20‚Äì40 ppm. Completed a normal water change with the usual large drain from both the sump and display.</li>
                          <li>Carried out light plant trimming, removing older or declining growth.</li>
                          <li>Moved a cuttlebone from the sump into the display tank to provide a more direct calcium source for livestock.</li>
                          <li>Dosed Prime during refill as part of the standard water-change routine.</li>
                          <li>System remains stable following maintenance.</li>
                      </ul>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-achievement">Maintenance</span>
                      <span class="card-tag tag-reflection">System Adjustment</span>
                  </div>
              </article>

              <!-- Weekly Maintenance & System Stabilization -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-21"
                       data-type="update"
                       data-category="maintenance"
                       data-focus="weekly-maintenance">
                  <div class="card-header">
                      <span class="card-icon">üßπ</span>
                      <h3>Weekly Maintenance &amp; System Stabilization</h3>
                      <time datetime="2025-12-21">December 21, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Weekly maintenance checklist during the post-BBA stabilization phase:</p>
                      <ul>
                          <li>Performed a scheduled water change as part of ongoing post-BBA stabilization.</li>
                          <li>Pre-water-change nitrate levels measured approximately 10‚Äì20 ppm, within target; drained roughly 90% of the sump and about 80% of the display.</li>
                          <li>Completed a moderate plant trimming, focusing on overall shape and removing older growth.</li>
                          <li>Replaced one filter sponge as part of routine filter upkeep.</li>
                          <li>Dosed Prime during refill and added Stability to support beneficial bacteria after introducing new filter media.</li>
                          <li>System remains stable following the end of Excel treatment, with ongoing focus on balanced nutrients and steady biological filtration.</li>
                      </ul>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-achievement">Maintenance</span>
                      <span class="card-tag tag-reflection">Stabilization</span>
                  </div>
              </article>

              <!-- Weekly Recap & Maintenance -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-15"
                       data-type="update"
                       data-category="maintenance"
                       data-focus="weekly-recap">
                  <div class="card-header">
                      <span class="card-icon">üõ†Ô∏è</span>
                      <h3>Weekly Recap &amp; Maintenance</h3>
                      <time datetime="2025-12-15">December 15, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Highlights from this week&#8217;s maintenance cycle:</p>
                      <ul>
                          <li>Performed the weekly water change with ~90% drained from the sump and ~75% from the display.</li>
                          <li>Pre&ndash;water change nitrate measured around 20 ppm.</li>
                          <li>Loss of one Celestial Pearl Danio ‚Äî first loss from the newest group; age at purchase unknown and losses can occur unexpectedly with small schooling fish.</li>
                          <li>Completed light moss trimming in the display and moved trimmings into the refugium for continued growth.</li>
                          <li>Finished maintenance with a standard cap dose of Seachem Excel.</li>
                          <li>Overall system remains stable.</li>
                      </ul>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-achievement">Maintenance</span>
                      <span class="card-tag tag-reflection">Weekly Recap</span>
                  </div>
              </article>

              <!-- Weekly Recap Kickoff -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-08"
                       data-type="update"
                       data-category="journal"
                       data-focus="weekly-recaps">
                  <div class="card-header">
                      <span class="card-icon">üóìÔ∏è</span>
                      <h3>December 2025 Weekly Recaps Begin</h3>
                      <time datetime="2025-12-08">December 8, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Completed December's first water change on December 7, 2025, kicking off the weekly recap cycle for the month.</p>

                      <p>Each weekly recap will track:</p>
                      <ul>
                          <li>Nitrates and key parameters</li>
                          <li>Plant health and growth</li>
                          <li>BBA control spot-checks</li>
                          <li>Any livestock changes or observations</li>
                      </ul>

                      <p><strong>Current status:</strong> Tank stable at 5 ppm nitrates, BBA nearly eliminated, all fish healthy with bright colors.</p>

                      <p>December 2025 logs will focus on confirming long-term stability after the successful BBA control push.</p>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-reflection">Weekly Recap</span>
                      <span class="card-tag tag-algae">Algae Control</span>
                      <span class="card-tag tag-achievement">Maintenance</span>
                  </div>
              </article>

              <!-- Weekly Recap: Post Water Change -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-08"
                       data-type="update"
                       data-category="maintenance"
                       data-focus="post-water-change">
                  <div class="card-header">
                      <span class="card-icon">üß™</span>
                      <h3>Post-Water-Change Weekly Recap</h3>
                      <time datetime="2025-12-08">December 8, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Conducted the first weekly check-in after the December 7 water change. Nitrate held steady around 5‚Äì10 ppm with clear water and no new algae patches forming.</p>

                      <p>Fed flakes and bloodworms; fish responded with strong appetite and normal behavior. Plants are pushing new growth where older leaves were trimmed back, and flow remains consistent after the sump sponge rinse.</p>

                      <p>Dosed a maintenance cap of Seachem Excel and deferred any additional water changes. Continuing to monitor BBA-prone spots while keeping nutrients stable.</p>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-achievement">Maintenance</span>
                      <span class="card-tag tag-reflection">Weekly Recap</span>
                  </div>
              </article>

              <!-- Standout Moment 1: Cherry Barb Farewell -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-03"
                       data-type="milestone"
                       data-category="fish-health"
                       data-event="cherry-barb-loss">
                  <div class="card-header">
                      <span class="card-icon">üêü</span>
                      <h3>Farewell to Original Cherry Barb</h3>
                      <time datetime="2025-12-03">December 3, 2025</time>
                  </div>
                  <div class="card-body">
                      <p>Lost one of the original cherry barbs from the 2017 crew today due to natural aging. At approximately 8 years old, this fish far exceeded the typical cherry barb lifespan of 3-5 years, demonstrating the tank's long-term stability and quality care over nearly a decade.</p>
                      
                      <p>This crew has been with me since the beginning‚Äîsurvivors of countless water changes, equipment upgrades, and my own learning curve as an aquarist. Losing a fish to old age after 8 years isn't a failure; it's proof that the fundamentals are working.</p>
                      
                      <p><strong>Tank Legacy:</strong> This cherry barb witnessed:</p>
                      <ul>
                          <li>Setup and initial cycling (2017)</li>
                          <li>Multiple equipment iterations and improvements</li>
                          <li>Transition to planted tank setup</li>
                          <li>Recent BBA treatment success (2025)</li>
                          <li>Hundreds of water changes and maintenance cycles</li>
                      </ul>
                      
                      <p class="celebration">All other fish from the original 2017 crew remain healthy with bright colors and normal behavior. The tank's long-term stability continues.</p>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-milestone">Milestone</span>
                      <span class="card-tag tag-reflection">Reflection</span>
                  </div>
              </article>

              <!-- Standout Moment 2: BBA Progress -->
              <article class="journal-card standout-moment"
                       data-date="2025-12-03"
                       data-type="achievement"
                       data-category="algae-control"
                       data-bba-status="95">
                  <div class="card-header">
                      <span class="card-icon">üßµ</span>
                      <h3>BBA Reduced to Minimal Levels</h3>
                      <time datetime="2025-12-03">Early December 2025</time>
                  </div>
                  <div class="card-body">
                      <p>After two months of targeted Excel spot treatments and flow optimization, BBA has been reduced to almost nothing. The November campaign was highly successful‚Äîwhat started as medium patches covering hardware and high-flow zones is now barely visible.</p>
                      
                      <p><strong>Treatment Strategy That Worked:</strong></p>
                      <ul>
                          <li>Daily Excel spot dosing on problem areas throughout November</li>
                          <li>Removed restrictive poly-fil from refugium chamber</li>
                          <li>Added coarse sponge to improve flow patterns</li>
                          <li>Maintained stable nitrates (5-10 ppm)</li>
                          <li>Amano shrimp grazing on weakened algae</li>
                      </ul>
                      
                      <p><strong>Current Status:</strong> Only trace amounts remain in isolated spots. Nearly all visible patches eliminated. Continuing routine Excel maintenance doses (1 capful) to prevent recurrence.</p>
                      
                      <p class="celebration">From approximately 50% coverage in early November to nearly 0% in early December. This validates the Excel + flow optimization approach for BBA control without plant damage.</p>
                  </div>
                  <div class="card-footer">
                      <span class="card-tag tag-achievement">Achievement</span>
                      <span class="card-tag tag-algae">Algae Control</span>
                  </div>
              </article>

          </div> <!-- End journal-grid -->

      </section> <!-- End december-2025 -->

      <!-- NOVEMBER 2025 SECTION (Monthly Archive Link) -->
      <section id="november-2025" class="month-section archive-month">
          <header class="month-header">
              <h2>November 2025</h2>
              <p class="month-description">Major maintenance and stabilization month. BBA nearly eliminated.</p>
          </header>
          <a href="/journal/november-2025.html" class="archive-link">
              View Full November 2025 Recap ‚Üí
          </a>
      </section>

      <!-- OCTOBER 2025 SECTION (Monthly Archive Link) -->
      <section id="october-2025" class="month-section archive-month">
          <header class="month-header">
              <h2>October 2025</h2>
              <p class="month-description">Tank stabilization and routine maintenance. Pre-BBA treatment baseline.</p>
          </header>
          <a href="/journal/october-2025.html" class="archive-link">
              View Full October 2025 Recap ‚Üí
          </a>
      </section>

  </main>

  <script src="/js/footer-loader.js?v=1.5.2" defer></script>
  <section class="legal-links" aria-label="Site legal links">
    <a href="/privacy-legal.html">Privacy Policy</a>
    <a href="/terms.html">Terms</a>
    <a href="/contact-feedback.html">Contact</a>
  </section>
  <noscript>
    <section class="legal-links" aria-label="Site legal links (noscript)">
      <a href="/privacy-legal.html">Privacy Policy</a>
      <a href="/terms.html">Terms</a>
      <a href="/contact-feedback.html">Contact</a>
    </section>
  </noscript>

  <div id="site-footer" data-footer-src="/footer.html?v=1.5.2"></div>

  <!-- Smooth Scroll Script -->
  <script>
      // Smooth scroll for month navigation
      document.querySelectorAll('.month-nav a').forEach(link => {
          link.addEventListener('click', function(e) {
              e.preventDefault();
              const targetId = this.getAttribute('href');
              const targetSection = document.querySelector(targetId);
              if (targetSection) {
                  targetSection.scrollIntoView({
                      behavior: 'smooth',
                      block: 'start'
                  });
                  // Update active state
                  document.querySelectorAll('.month-nav a').forEach(a => a.classList.remove('active'));
                  this.classList.add('active');
              }
          });
      });

      // Sticky dashboard intersection observer
      const observer = new IntersectionObserver(
          ([e]) => e.target.classList.toggle('is-pinned', e.intersectionRatio < 1),
          { threshold: [1] }
      );
      const dashboard = document.getElementById('tank-dashboard');
      if (dashboard) observer.observe(dashboard);
  </script>

  <script>
    (() => {
      const elements = {
        nitrates: document.getElementById('param-nitrates'),
        lastTest: document.getElementById('param-last-test'),
        tankHealth: document.getElementById('param-tank-health'),
        nextWaterChange: document.getElementById('param-next-water-change')
      };

      if (!elements.nitrates || !elements.lastTest || !elements.tankHealth || !elements.nextWaterChange) return;

      const statusClasses = ['status-good', 'status-warning', 'status-alert'];
      const statusClassMap = {
        Excellent: 'status-good',
        Good: 'status-good',
        Moderate: 'status-warning',
        Elevated: 'status-alert',
        Critical: 'status-alert',
        Unknown: ''
      };

      const formatDate = (value) => {
        const date = value instanceof Date ? value : new Date(value);
        if (Number.isNaN(date.getTime())) return '--';
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
      };

      const addDays = (value, days) => {
        const date = new Date(value);
        if (Number.isNaN(date.getTime())) return null;
        date.setDate(date.getDate() + days);
        return date;
      };

      class JournalDataLoader {
        constructor() {
          this.allReadings = [];
          this.legacySources = [
            '/data/journal.json',
            '/data/reads.json',
            '/data/journal-archive-sept2024.json',
            '/data/journal-archive-aug2024.json',
            '/data/journal-archive-jul2024.json'
          ];
        }

        async loadAllData() {
          await this.loadMonthlyFiles();

          for (const source of this.legacySources) {
            await this.loadFile(source);
          }

          this.allReadings.sort((a, b) => new Date(a.date) - new Date(b.date));
          return this.allReadings;
        }

        async loadMonthlyFiles() {
          try {
            const response = await fetch('/data/journal/index.json', { cache: 'no-store' });
            if (!response.ok) return;
            const months = await response.json();

            for (const month of months) {
              await this.loadFile(`/data/journal/${month}.json`);
            }
          } catch (error) {
            console.error('Error loading monthly journal index', error);
          }
        }

        extractPpm(entry) {
          if (entry.nitrate_ppm) {
            const match = String(entry.nitrate_ppm).match(/^(\d+(?:\.\d+)?)/);
            if (match) return parseFloat(match[1]);
          }

          if (Array.isArray(entry.parameters)) {
            const nitrateParam = entry.parameters.find((p) => p?.name && p.name.toLowerCase().includes('nitrate'));
            if (nitrateParam?.value != null) {
              const cleaned = String(nitrateParam.value).replace(/ppm/i, '').trim();
              const num = parseFloat(cleaned);
              if (!Number.isNaN(num)) return num;
            }
          }

          if (entry.body) {
            const patterns = [
              /(\d+(?:\.\d+)?)\s*ppm/i,
              /nitrate[s]?\s+(?:tested|measured|reading|at|came in at|held steady around)\s+(?:at\s+)?(\d+(?:\.\d+)?)/i,
              /(\d+(?:\.\d+)?)\s*(?:‚Äì|-)\s*\d+\s*ppm/i
            ];
            for (const pattern of patterns) {
              const match = entry.body.match(pattern);
              if (match) return parseFloat(match[1]);
            }
          }

          return null;
        }

        addReading(reading) {
          if (!reading.date || Number.isNaN(new Date(reading.date).getTime())) return;
          const ppm = typeof reading.ppm === 'number' ? reading.ppm : parseFloat(reading.ppm);
          if (Number.isNaN(ppm)) return;

          const exists = this.allReadings.some((r) => r.date === reading.date && Math.abs(r.ppm - ppm) < 0.01 && r.wc === reading.wc);
          if (!exists) {
            this.allReadings.push({ ...reading, ppm });
          }
        }

        processEntry(entry, source) {
          const testDate = entry.date || entry.test_date;
          if (!testDate || Number.isNaN(new Date(testDate).getTime())) return;

          const ppm = this.extractPpm(entry);
          const isWaterChange =
            entry.water_change === true ||
            (entry.category && entry.category.toLowerCase().includes('maintenance')) ||
            (entry.body && entry.body.toLowerCase().includes('water change'));

          if (ppm !== null && !Number.isNaN(ppm)) {
            this.addReading({ date: testDate, ppm, wc: isWaterChange, source });
          } else if (isWaterChange) {
            this.addReading({ date: testDate, ppm: 0, wc: true, source });
          }
        }

        async loadFile(url) {
          try {
            const response = await fetch(`${url}?cb=${Date.now()}`, { cache: 'no-store' });
            if (!response.ok) return;
            const data = await response.json();

            if (Array.isArray(data)) {
              data.forEach((entry) => this.processEntry(entry, url));
            } else if (Array.isArray(data.entries)) {
              data.entries.forEach((entry) => this.processEntry(entry, url));
            } else if (Array.isArray(data.nitrate)) {
              data.nitrate.forEach((r) => {
                if (!r.date || Number.isNaN(new Date(r.date).getTime())) return;
                const ppm = typeof r.ppm === 'number' ? r.ppm : parseFloat(r.ppm);
                if (Number.isNaN(ppm)) return;
                this.addReading({ date: r.date, ppm, wc: Boolean(r.wc), source: url });
              });
            }
          } catch (error) {
            console.error('Error loading journal data from', url, error);
          }
        }

        getStatus(ppm) {
          if (ppm < 10) return 'Excellent';
          if (ppm < 20) return 'Good';
          if (ppm < 40) return 'Moderate';
          if (ppm < 80) return 'Elevated';
          return 'Critical';
        }
      }

      const updateStatus = (status) => {
        const className = statusClassMap[status] || '';
        statusClasses.forEach((cls) => elements.tankHealth.classList.remove(cls));
        if (className) elements.tankHealth.classList.add(className);
        elements.tankHealth.textContent = status;
      };

      const updateTimeElement = (el, date) => {
        if (!el) return;
        const formatted = formatDate(date);
        el.textContent = formatted;

        const parsed = new Date(date);
        if (!Number.isNaN(parsed.getTime())) {
          el.setAttribute('datetime', parsed.toISOString().slice(0, 10));
        }
      };

      const updateCard = (readings, loader) => {
        if (!readings.length) return;

        const latest = [...readings].reverse().find((r) => typeof r.ppm === 'number' && !Number.isNaN(r.ppm));
        const lastWaterChange = [...readings].reverse().find((r) => r.wc === true);

        if (latest) {
          elements.nitrates.textContent = `${latest.ppm} ppm`;
          updateTimeElement(elements.lastTest, latest.date);
          updateStatus(loader.getStatus(latest.ppm));
        }

        if (lastWaterChange) {
          const nextDate = addDays(lastWaterChange.date, 7);
          if (nextDate) updateTimeElement(elements.nextWaterChange, nextDate);
        }
      };

      const init = async () => {
        try {
          const loader = new JournalDataLoader();
          const readings = await loader.loadAllData();
          updateCard(readings, loader);
        } catch (error) {
          console.error('Unable to update Current Parameters card', error);
        }
      };

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Organization",
        "@id": "https://thetankguide.com/#organization",
        "name": "FishKeepingLifeCo",
        "alternateName": ["The Tank Guide", "Fish Keeping Life Co", "fishkeepinglife"],
        "description": "FishKeepingLifeCo is an educational publishing company specializing in beginner-friendly aquarium science. The Tank Guide is our flagship website providing interactive tools and research-backed fishkeeping guidance for families and new hobbyists.",
        "url": "https://thetankguide.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://thetankguide.com/assets/img/Logo-Master-512x512.PNG",
          "width": 512,
          "height": 512
        },
        "sameAs": [
          "https://www.tiktok.com/@fishkeepinglifeco",
          "https://www.instagram.com/fishkeepinglifeco",
          "https://www.youtube.com/@FishKeepingLifeCo",
          "https://x.com/fishkeepinglife",
          "https://www.facebook.com/FishKeepingLifeCo",
          "https://www.threads.net/@fishkeepinglifeco",
          "https://www.reddit.com/u/FishKeepingLifeCo"
        ]
      },
      {
        "@type": "WebSite",
        "@id": "https://thetankguide.com/#website",
        "url": "https://thetankguide.com/",
        "name": "The Tank Guide",
        "description": "The Tank Guide is an educational aquarium website from FishKeepingLifeCo, offering tools, guides, and beginner friendly resources.",
        "publisher": { "@id": "https://thetankguide.com/#organization" },
        "inLanguage": "en-US",
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://thetankguide.com/search?q={search_term_string}"
          },
          "query-input": {
            "@type": "PropertyValueSpecification",
            "valueRequired": true,
            "valueName": "search_term_string"
          }
        }
      },
      {
        "@type": "WebPage",
        "@id": "https://thetankguide.com/journal.html",
        "url": "https://thetankguide.com/journal.html",
        "name": "Aquarium Journal - Real Tank Data & Maintenance Logs | The Tank Guide",
        "description": "Follow real aquarium logs from FishKeepingLifeCo home tanks, including water testing, maintenance, and livestock changes that inform The Tank Guide tools and Daily Tank Journals.",
        "inLanguage": "en-US",
        "isPartOf": { "@id": "https://thetankguide.com/#website" },
        "publisher": { "@id": "https://thetankguide.com/#organization" },
        "author": { "@id": "https://thetankguide.com/#organization" }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://thetankguide.com/journal.html#breadcrumb",
        "itemListElement": [
          { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://thetankguide.com/" },
          { "@type": "ListItem", "position": 2, "name": "Journal", "item": "https://thetankguide.com/journal.html" }
        ]
      }
    ]
  }
  </script>

<!-- === TTG CMP Consent Bridge START === -->
<script>
(function(){
  // Helper: map TCF consent to our single "ads granted" flag.
  // We consider "granted" only when Purpose 1 (storage) AND Purpose 4 (select personalised ads)
  // are consented. If you want to allow NON-personalised ads when only Purpose 1 is granted,
  // set allowNPA=true below.
  var allowNPA = true; // if true, we'll treat Purpose 1 only as "granted" for showing slots (Google will serve NPA ads).

  function setAdConsent(granted){
    // Google CMP interface (Funding Choices) ‚Äî set consent for ads_storage and ad_user_data
    var consentState = granted ? 'granted' : 'denied';
    var payload = {
      'ad_storage': consentState,
      'ad_user_data': consentState,
      'ad_personalization': consentState
    };
    if (typeof window.__ttgUpdateConsentState__ === 'function') {
      window.__ttgUpdateConsentState__(payload);
    } else if (typeof window.gtag === 'function') {
      window.gtag('consent', 'update', payload);
    } else {
      (window.__ttgDeferredConsentUpdates__ = window.__ttgDeferredConsentUpdates__ || []).push(payload);
    }
  }

  function hookTCF(){
    // Funding Choices exposes the IAB TCF v2 interface.
    // We hook into it to map Purpose consent to Google consent mode.
    if (typeof __tcfapi !== 'function') return;

    __tcfapi('addEventListener', 2, function(tcData, success){
      if(!success || !tcData || tcData.eventStatus !== 'tcloaded') return;

      // Purpose IDs: 1 = Storage and Access, 4 = Select Personalised Ads
      var p1 = tcData.purpose && tcData.purpose.consents ? tcData.purpose.consents[1] : false;
      var p4 = tcData.purpose && tcData.purpose.consents ? tcData.purpose.consents[4] : false;

      var granted = allowNPA ? (p1 && (p4 || true)) : (p1 && p4);
      setAdConsent(granted);
    });
  }

  // Initialize once Funding Choices loads the TCF stub
  if (typeof __tcfapi === 'function') {
    hookTCF();
  } else {
    window.addEventListener('tcfapiReady', hookTCF, { once: true });
  }
})();
</script>
<!-- === TTG CMP Consent Bridge END === -->
</body>
</html>
