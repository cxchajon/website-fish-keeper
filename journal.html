<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KTRVCMQN');</script>
  <!-- End Google Tag Manager -->
  <link rel="preload" href="/footer.html?v=1.5.2" as="fetch" crossorigin="anonymous">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FishKeepingLifeCo Journal — Real Aquarium Logs and Water Change History | The Tank Guide</title>
  <meta name="description" content="See how we track our 29-gallon planted tank daily. Water tests, dosing, maintenance, and problem-solving from a real working aquarium." />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://thetankguide.com/journal.html" />
  <meta property="og:site_name" content="The Tank Guide" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="FishKeepingLifeCo Journal — Real Aquarium Logs and Water Change History | The Tank Guide" />
  <meta property="og:description" content="Study real aquarium logs from FishKeepingLifeCo’s home tanks: water tests, maintenance, and livestock changes that power The Tank Guide’s tools and journals." />
  <meta property="og:url" content="https://thetankguide.com/journal.html" />
  <meta property="og:image" content="https://thetankguide.com/assets/img/logos/logo-1200x630.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="FishKeepingLifeCo logo (1200×630)." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://thetankguide.com/journal.html" />
  <meta name="twitter:title" content="FishKeepingLifeCo Journal — Real Aquarium Logs and Water Change History | The Tank Guide" />
  <meta name="twitter:description" content="Study real aquarium logs from FishKeepingLifeCo’s home tanks: water tests, maintenance, and livestock changes that power The Tank Guide’s tools and journals." />
  <meta name="twitter:image" content="https://thetankguide.com/assets/img/logos/logo-1200x630.png" />
  <meta name="twitter:image:alt" content="FishKeepingLifeCo logo (1200×630)." />
  <script src="/js/nav.js?v=1.1.0" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Patrick+Hand&amp;family=Kalam:wght@300;400&amp;display=swap" as="style">
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Patrick+Hand&amp;family=Kalam:wght@300;400&amp;display=swap"
        media="print"
        onload="this.media='all'">
  <link rel="stylesheet" href="/css/main.bundle.css?v=2025-11-07">
  <style>
    :root {
      color-scheme: light;
    }

    body {
      margin: 0;
      color: #2b2b2b;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(168, 196, 255, 0.45) 0px,
          rgba(168, 196, 255, 0.45) 1px,
          #fcf4d9 1px,
          #fcf4d9 40px
        ),
        #fcf4d9;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0 auto 0 18px;
      width: 2px;
      background: rgba(235, 87, 87, 0.7);
      pointer-events: none;
    }

    main.legalpad-page {
      max-width: 880px;
      margin: 48px auto 32px;
      padding: 0 24px 64px;
      display: block;
    }

    .legalpad-page h1 {
      margin: 0 0 8px;
      font-size: clamp(1.9rem, 2.5vw + 1.3rem, 2.6rem);
      font-weight: 700;
      letter-spacing: 0.015em;
    }

    .legalpad-page .intro-text {
      margin: 0 0 32px;
      max-width: 640px;
      color: rgba(43, 43, 43, 0.75);
      font-size: 1rem;
      line-height: 1.6;
    }

    /* scope to journal page only */
    main.legalpad-page { /* background provided by site; keep transparent */ }

    /* Remove all “card/panel” chrome inside journal area */
    .legalpad-page .entry,
    .legalpad-page .entry-card,
    .legalpad-page .panel,
    .legalpad-page .card {
      background: transparent !important;
      border: 0 !important;
      box-shadow: none !important;
      padding: 0 !important;
      margin: 0 0 28px 0 !important;
    }

    /* Handwriting for body text ONLY (keep site headings/nav with brand font) */
    .legalpad-page .entry-body,
    .legalpad-page .entry-body p,
    .legalpad-page .entry-body li {
      font-family: "Patrick Hand", "Kalam", system-ui, sans-serif;
      font-size: 20px;
      line-height: 1.9;
      letter-spacing: 0.15px;
      color: #252525;
      background: transparent;
    }

    /* Titles/meta keep brand font (NOT handwriting) */
    .legalpad-page h1,
    .legalpad-page h2,
    .legalpad-page .entry-title,
    .legalpad-page .entry-meta {
      font-family: inherit;
      background: transparent;
    }

    .legalpad-page .entry-title {
      font-size: clamp(1.25rem, 1vw + 1.2rem, 1.6rem);
      margin: 0 0 6px;
    }

    .legalpad-page .entry-meta {
      font-size: 0.95rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      margin: 0 0 12px;
      color: rgba(37, 37, 37, 0.65);
    }

    .legalpad-page .entry-body p {
      margin: 0 0 18px;
    }

    /* Journal images fit writing column and never overflow */
    .legalpad-page .entry-body img,
    .legalpad-page .journal-photo {
      display: block;
      max-width: 680px;
      width: 100%;
      height: auto;
      border-radius: 6px;
      margin: 12px 0 8px 0;
    }

    .journal-photos {
      margin: 0.5rem 0;
    }

    .journal-figure {
      margin: 0.75rem 0 1.25rem;
    }

    .journal-photo {
      width: 100%;
      height: auto;
      border-radius: 6px;
      display: block;
    }

    .journal-figcaption {
      font-size: 0.9rem;
      opacity: 0.85;
      margin-top: 0.25rem;
    }

    .month-nav {
      margin: -12px 0 28px;
      padding: 0;
    }

    .month-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-wrap: wrap;
      gap: 12px 20px;
    }

    .month-nav a {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.4);
      color: inherit;
      text-decoration: none;
      border: 1px solid rgba(37, 37, 37, 0.08);
      box-shadow: 0 1px 0 rgba(0, 0, 0, 0.04);
    }

    .month-nav a:hover,
    .month-nav a:focus-visible {
      background: rgba(255, 255, 255, 0.75);
      outline: none;
      box-shadow: 0 0 0 2px rgba(37, 37, 37, 0.12);
    }

    @media (max-width: 640px) {
      body::before {
        left: 12px;
      }

      main.legalpad-page {
        margin: 32px auto 24px;
        padding: 0 16px 56px;
      }

      .legalpad-page .entry-title {
        font-size: clamp(1.2rem, 2.4vw + 1rem, 1.4rem);
      }

      .legalpad-page .entry-meta {
        font-size: 0.85rem;
      }
    }
  </style>
  <!-- Consent Mode defaults (runs after GA loader) -->
  <script src="/assets/js/consent-mode.js" defer></script>
  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token": "fef22cbf19e3473db5ec987a8f3bf4f3"}'></script>
  <!-- End Cloudflare Web Analytics -->
<!-- --- Google CMP (Funding Choices) START --- -->
  <script async src="https://fundingchoicesmessages.google.com/i/pub-9905718149811880?ers=1"></script>
  <script>
    // Required bootstrap per Google; signals CMP presence
    (function() {
      function signalGooglefcPresent() {
        if (!window.frames['googlefcPresent']) {
          if (document.body) {
            const iframe = document.createElement('iframe');
            iframe.style.cssText = 'display:none';
            iframe.name = 'googlefcPresent';
            document.body.appendChild(iframe);
          } else {
            setTimeout(signalGooglefcPresent, 0);
          }
        }
      }
      signalGooglefcPresent();
    })();
  </script>
  <!-- --- Google CMP (Funding Choices) END --- -->
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTRVCMQN"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <div id="site-nav"></div>
  <main id="journal" class="legalpad-page" aria-label="Tank Journal" data-journal-source="/data/journal/2025-11.json">
    <header>
      <h1>Live Tank Journal: 29-Gallon Planted Aquarium</h1>
      <p class="intro-text">Water tests, maintenance, dosing, and observations from an active 29-gallon planted tank. Track how patterns emerge and problems get solved in real time.</p>
      <p class="intro-text">Browse past entries by month — same tank, continuous tracking since August 2025:</p>
      <nav class="month-nav" aria-label="Journal month archive navigation">
        <ul>
          <li><a href="/journal/2025-11.html">November 2025</a></li>
          <li><a href="/journal/2025-10.html">October 2025</a></li>
          <li><a href="/journal/2025-09.html">September 2025</a></li>
        </ul>
      </nav>
    </header>

    <div id="journal-entries" class="jp-list" aria-live="polite"></div>

    <article class="entry">
      <h2 class="entry-title">2025-11-20 | Feeding, Test &amp; Dosing &amp; Filtration Update</h2>
      <div class="entry-body">
        <p>Feeding: Brine shrimp + flakes. Nitrates measured around 5 ppm (low range). Dosed 4 pumps of NilocG Thrive Plus fertilizer and skipped Seachem Excel to avoid stressing sensitive plants. Added a bag of Seachem Matrix to the filter chamber to weigh down floating filter pads, expand biomedia capacity, and support long-term beneficial bacteria stability. Tank remains stable with strong feeding response; fertilizer dose increased today due to the low nitrate reading.</p>
        <figure class="journal-figure">
          <img
            class="journal-photo"
            src="/assets/images/filter-chamber-update-2025-11-20-matrix.jpeg"
            alt="Filter chamber update with Seachem Matrix bag installed (November 20, 2025)"
            loading="lazy"
            decoding="async"
          >
        </figure>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-19 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate tested at 5 ppm. Fed flakes and bloodworms. Spot- and cap-dosed Seachem Excel. BBA nearly gone; only a small area remains in a sensitive plant zone, so treatment is applied carefully to avoid damaging plant tissue.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-18 | Feeding</h2>
      <div class="entry-body">
        <p>Fed algae wafers and flakes for veggie day. Fish responded well and feeding was consistent.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-09 | Maintenance</h2>
      <div class="entry-body">
        <p>Pre-water-change nitrate tested at 40 ppm, prompting a deep clean with roughly 90% of the sump and 75% of the display refreshed.</p>
        <p>Installed a new poly-fil barrier to keep debris out of the pump chamber and maintain water clarity as the system settles post-maintenance.</p>
        <div class="journal-photos" aria-label="journal photos">
          <figure class="journal-figure">
            <img
              class="journal-photo"
              src="/assets/images/2025-11-09-sump-top-poly.jpg"
              alt="Top-down view of the sump after installing the new poly-fil barrier. Plants visible in the refugium section."
              loading="lazy"
              decoding="async"
            >
            <figcaption class="journal-figcaption">Top view — new poly-fil layer added above the refugium for debris control.</figcaption>
          </figure>
          <figure class="journal-figure">
            <img
              class="journal-photo"
              src="/assets/images/2025-11-09-sump-front-poly.jpg"
              alt="Front view showing the sump chambers with fresh poly-fil installed for mechanical filtration and flow clarity."
              loading="lazy"
              decoding="async"
            >
            <figcaption class="journal-figcaption">Front view — poly-fil barrier placed to prevent debris from reaching the pump chamber.</figcaption>
          </figure>
          <figure class="journal-figure">
            <img
              class="journal-photo"
              src="/assets/images/2025-11-09-sump-filled-poly.jpg"
              alt="Full sump setup showing all chambers after refill. Clear flow path and new filter media in place."
              loading="lazy"
              decoding="async"
            >
            <figcaption class="journal-figcaption">System refilled — flow restored and water clarity improving post-maintenance.</figcaption>
          </figure>
        </div>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-06 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate measured at 20 ppm with the community fed flakes and brine shrimp alongside a spot dose of Seachem Excel.</p>
        <p>The last traces of BBA near the random flow generator have cleared, closing out the Post-Treatment Recovery Week on a high note.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-05 | Feeding &amp; Dosing</h2>
      <div class="entry-body">
        <p>Fed flakes and bloodworms with a targeted spot dose of Seachem Excel to keep algae pressure light.</p>
        <p>Fish activity and appetite remain strong as the system holds steady through Post-Treatment Recovery Week.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-04 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate tested under 5 ppm. Dosed four pumps of NilocG Thrive Plus and added a spot dose of Seachem Excel.</p>
        <p>Fed algae wafers with a pinch of flakes so every fish got a share, keeping nutrients low yet stable during Post-Treatment Recovery Week.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-03 | Feeding, Dosing &amp; Observation</h2>
      <div class="entry-body">
        <p>Fed flakes and brine shrimp with two spot doses of Seachem Excel to keep BBA in check.</p>
        <p>Malaysian trumpet snails naturally polished the sump overflow screen, keeping debris away and signaling a “Natural Balance Discovery” milestone as the system self-regulates during Post-Treatment Recovery Week.</p>
        <img
          class="journal-photo"
          src="/assets/images/mts-on-strainer-2025-11-03.jpg"
          alt="Malaysian trumpet snails cleaning the overflow screen"
          loading="lazy"
        >
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-11-02 | Maintenance &amp; Dosing</h2>
      <div class="entry-body">
        <p>Pre-water-change nitrate tested between 20–40 ppm (closer to 20). Completed roughly 95% sump and 70% display water changes with a light trim.</p>
        <p>Performed spot and cap doses of Seachem Excel as a routine post-change treatment and noted fresh plant growth emerging.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-10-31 | Feeding</h2>
      <div class="entry-body">
        <p>Served a light portion of flakes only for the planned low-waste day while continuing Post-Treatment Recovery Week.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-10-30 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate measured between 10–20 ppm (leaning closer to 20). Fed flakes and brine shrimp alongside spot and cap doses of Seachem Excel.</p>
        <p>Black beard algae around equipment has fully turned red, marking the start of Post-Treatment Recovery Week as the die-off phase takes hold.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-10-29 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate came in at 10 ppm. Fed flakes and bloodworms, then spot and cap dosed Seachem Excel targeting remaining BBA near the random flow generator.</p>
        <p>Amano shrimp grazed in the treated area, showing renewed activity and signaling a recovering ecosystem.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-10-28 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Fed three algae wafers and a small pinch of flakes to ensure the entire community ate. Nitrate registered at 5 ppm.</p>
        <p>Dosed four pumps of NilocG Thrive Plus. System remains stable and balanced following the recent maintenance cycle.</p>
      </div>
    </article>

    <article class="entry">
      <h2 class="entry-title">2025-10-27 | Feeding, Test &amp; Dosing</h2>
      <div class="entry-body">
        <p>Nitrate tested at or below 5 ppm. Dosed one cap plus spot applications of Seachem Excel.</p>
        <p>Fed flakes and brine shrimp while the tank remained stable post-maintenance.</p>
      </div>
    </article>
  </main>

  <script src="/js/footer-loader.js?v=1.5.2" defer></script>
  <section class="legal-links" aria-label="Site legal links">
    <a href="/privacy-legal.html">Privacy Policy</a>
    <a href="/terms.html">Terms</a>
    <a href="/contact-feedback.html">Contact</a>
  </section>
  <noscript>
    <section class="legal-links" aria-label="Site legal links (noscript)">
      <a href="/privacy-legal.html">Privacy Policy</a>
      <a href="/terms.html">Terms</a>
      <a href="/contact-feedback.html">Contact</a>
    </section>
  </noscript>

  <div id="site-footer" data-footer-src="/footer.html?v=1.5.2"></div>

  <script>
    (function () {
      const journalElement = document.getElementById('journal');
      const container = document.getElementById('journal-entries');
      const log = (...args) => console.log('[Journal]', ...args);
      const error = (...args) => console.error('[Journal]', ...args);

      const dataSource = journalElement && journalElement.dataset ? journalElement.dataset.journalSource : '';
      const journalSource = (dataSource && dataSource.trim()) || '/data/journal/2025-11.json';

      if (!container) {
        error('Missing #journal-entries container.');
        return;
      }

      const fallbackEntries = Array.from(document.querySelectorAll('#journal > .entry'));

      const clearFallbackEntries = () => {
        fallbackEntries.forEach((entry) => {
          if (entry.parentNode) {
            entry.parentNode.removeChild(entry);
          }
        });
      };

      const toLongDate = (value) => {
        if (!value) return '';
        const [year, month, day] = value.split('-').map(Number);
        if (!year || !month || !day) return value;
        const date = new Date(Date.UTC(year, month - 1, day));
        return date.toLocaleDateString(undefined, {
          month: 'long',
          day: 'numeric',
          year: 'numeric'
        });
      };

      const paragraphize = (parent, text) => {
        if (!text) return;
        String(text)
          .split(/\r?\n+/)
          .map((segment) => segment.trim())
          .filter(Boolean)
          .forEach((segment) => {
            const p = document.createElement('p');
            p.textContent = segment;
            parent.appendChild(p);
          });
      };

      const addPhotoFigure = (parent, photo) => {
        if (!photo || !photo.src) return;
        const figure = document.createElement('figure');
        figure.className = 'journal-figure';

        const img = document.createElement('img');
        img.className = 'journal-photo';
        img.src = photo.src;
        if (photo.alt) img.alt = photo.alt;
        img.loading = 'lazy';
        img.decoding = 'async';
        figure.appendChild(img);

        if (photo.caption) {
          const figcaption = document.createElement('figcaption');
          figcaption.className = 'journal-figcaption';
          figcaption.textContent = photo.caption;
          figure.appendChild(figcaption);
        }

        parent.appendChild(figure);
      };

      const createEntryElement = (entry) => {
        const article = document.createElement('article');
        article.className = 'entry';

        const titleParts = [];
        if (entry.date) titleParts.push(entry.date);
        if (entry.title) titleParts.push(entry.title);
        else if (entry.category) titleParts.push(entry.category);
        else if (entry.quickFacts) titleParts.push(entry.quickFacts);
        const title = document.createElement('h2');
        title.className = 'entry-title';
        title.textContent = titleParts.filter(Boolean).join(' | ') || 'Journal Entry';
        article.appendChild(title);

        const body = document.createElement('div');
        body.className = 'entry-body';

        if (entry.quickFacts) {
          const quickFacts = document.createElement('p');
          quickFacts.textContent = entry.quickFacts;
          body.appendChild(quickFacts);
        }

        paragraphize(body, entry.body);
        paragraphize(body, entry.ramble);
        paragraphize(body, entry.notes);
        paragraphize(body, entry.actionObservation);

        if (entry.nitrate || entry.dosing || entry.waterChange || entry.thrivePlus) {
          const details = document.createElement('p');
          const detailParts = [];
          if (entry.nitrate) detailParts.push(`Nitrate: ${entry.nitrate}`);
          if (entry.dosing) detailParts.push(`Dosing: ${entry.dosing}`);
          if (entry.thrivePlus) detailParts.push(`Thrive Plus: ${entry.thrivePlus}`);
          if (entry.waterChange) detailParts.push(`Water change: ${entry.waterChange}`);
          details.textContent = detailParts.join(' · ');
          body.appendChild(details);
        }

        const photos = Array.isArray(entry.photos) ? entry.photos : [];
        photos.forEach((photo) => addPhotoFigure(body, photo));

        if (entry.media && typeof entry.media === 'string') {
          addPhotoFigure(body, { src: entry.media, alt: entry.mediaAlt, caption: entry.mediaCaption });
        }

        if (entry.tags && entry.tags.length) {
          const tags = Array.isArray(entry.tags) ? entry.tags : String(entry.tags).split(',');
          const tagLine = document.createElement('p');
          tagLine.textContent = `Tags: ${tags.map((tag) => tag.trim()).filter(Boolean).join(', ')}`;
          body.appendChild(tagLine);
        }

        if (!body.children.length) {
          const fallback = document.createElement('p');
          fallback.textContent = 'No additional details provided.';
          body.appendChild(fallback);
        }

        article.appendChild(body);
        return article;
      };

      const renderEntries = (entries, source) => {
        if (!Array.isArray(entries) || !entries.length) {
          throw new Error('No entries available to render.');
        }
        clearFallbackEntries();
        container.innerHTML = '';
        entries.forEach((entry) => {
          container.appendChild(createEntryElement(entry));
        });
        log(`Rendered from ${source}:`, entries.length, 'entries');
        window.__journalLogs = window.__journalLogs || [];
        window.__journalLogs.push({ level: 'log', message: `Rendered from ${source}`, count: entries.length });
        window.__journalRenderedSource = source;
        window.__journalRenderedCount = entries.length;
      };

      const parseCsv = (text) => {
        const rows = [];
        let current = '';
        let row = [];
        let inQuotes = false;
        for (let i = 0; i < text.length; i += 1) {
          const char = text[i];
          if (char === '"') {
            if (inQuotes && text[i + 1] === '"') {
              current += '"';
              i += 1;
            } else {
              inQuotes = !inQuotes;
            }
          } else if (char === ',' && !inQuotes) {
            row.push(current);
            current = '';
          } else if ((char === '\n' || char === '\r') && !inQuotes) {
            if (char === '\r' && text[i + 1] === '\n') {
              i += 1;
            }
            row.push(current);
            rows.push(row);
            row = [];
            current = '';
          } else {
            current += char;
          }
        }
        if (current.length || row.length) {
          row.push(current);
          rows.push(row);
        }
        return rows
          .map((cols) => cols.map((col) => col.trim()))
          .filter((cols) => cols.some((col) => col));
      };

      const normalizeJsonEntries = (data) => {
        if (!Array.isArray(data)) return [];
        return data.map((item) => ({
          date: item.date || '',
          time: item.time || '',
          title: item.title || '',
          category: item.category || '',
          body: item.body || '',
          ramble: item.ramble || '',
          quickFacts: item.quick_facts || '',
          notes: item.notes || '',
          nitrate: item.nitrate_ppm || '',
          dosing: item.dosing || '',
          thrivePlus: item.thrive_plus || '',
          waterChange: item.water_change || '',
          tags: item.tags || '',
          photos: item.photos || [],
          media: item.media || '',
          mediaAlt: item.media_alt || '',
          mediaCaption: item.media_caption || ''
        }));
      };

      const normalizeCsvEntries = (text) => {
        const rows = parseCsv(text);
        if (!rows.length) return [];
        const headers = rows[0];
        const entries = rows.slice(1).map((cols) => {
          const record = {};
          headers.forEach((header, index) => {
            record[header] = cols[index] || '';
          });
          return {
            date: record['Date'] || '',
            time: record['Time'] || '',
            category: record['Category'] || '',
            actionObservation: record['Action/Observation'] || '',
            notes: record['Notes/Results'] || '',
            nitrate: record['Nitrate(ppm)'] || '',
            dosing: record['Dosing'] || '',
            thrivePlus: record['ThrivePlus(pumps)'] || '',
            waterChange: record['WaterChange'] || '',
            tags: record['tags'] || '',
            media: record['Image'] || ''
          };
        });
        return entries.filter((entry) => entry.date);
      };

      const sortEntries = (entries) => {
        return entries.slice().sort((a, b) => {
          if (a.date === b.date) return 0;
          return a.date > b.date ? -1 : 1;
        });
      };

      const fetchJsonEntries = async () => {
        const baseUrl = journalSource;
        const jsonUrl = `${baseUrl}?cb=${Date.now()}`;
        const response = await fetch(jsonUrl, { cache: 'no-store' });
        if (!response.ok) {
          throw new Error(`JSON request failed with status ${response.status}`);
        }
        const data = await response.json();
        return sortEntries(normalizeJsonEntries(data));
      };

      const fetchCsvEntries = async () => {
        const baseUrl = '/data/journal.csv';
        const csvUrl = `${baseUrl}?cb=${Date.now()}`;
        const response = await fetch(csvUrl, { cache: 'no-store' });
        if (!response.ok) {
          throw new Error(`CSV request failed with status ${response.status}`);
        }
        const text = await response.text();
        return sortEntries(normalizeCsvEntries(text));
      };

      const showError = (message) => {
        container.innerHTML = '';
        const article = document.createElement('article');
        article.className = 'entry';

        const title = document.createElement('h2');
        title.className = 'entry-title';
        title.textContent = 'Journal temporarily unavailable';
        article.appendChild(title);

        const meta = document.createElement('p');
        meta.className = 'entry-meta';
        meta.textContent = 'Please try refreshing the page in a moment.';
        article.appendChild(meta);

        const body = document.createElement('div');
        body.className = 'entry-body';
        const p = document.createElement('p');
        p.textContent = message;
        body.appendChild(p);
        article.appendChild(body);

        container.appendChild(article);
      };

      const start = async () => {
        try {
          const jsonEntries = await fetchJsonEntries();
          renderEntries(jsonEntries, 'JSON');
          log('Loaded entries from JSON source:', journalSource);
        } catch (jsonError) {
          error('JSON fetch failed:', jsonError);
          try {
            const csvEntries = await fetchCsvEntries();
            renderEntries(csvEntries, 'CSV');
            log('Loaded entries from CSV fallback.');
          } catch (csvError) {
            error('CSV fetch failed:', csvError);
            showError('We couldn\'t load the journal entries just now. They\'ll be back after a quick refresh.');
          }
        }
      };

      start();
    })();
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Organization",
        "@id": "https://thetankguide.com/#organization",
        "name": "FishKeepingLifeCo",
        "alternateName": ["The Tank Guide", "Fish Keeping Life Co", "fishkeepinglife"],
        "description": "FishKeepingLifeCo is an educational publishing company specializing in beginner-friendly aquarium science. The Tank Guide is our flagship website providing interactive tools and research-backed fishkeeping guidance for families and new hobbyists.",
        "url": "https://thetankguide.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://thetankguide.com/assets/img/Logo-Master-512x512.PNG",
          "width": 512,
          "height": 512
        },
        "sameAs": [
          "https://www.tiktok.com/@fishkeepinglifeco",
          "https://www.instagram.com/fishkeepinglifeco",
          "https://www.youtube.com/@FishKeepingLifeCo",
          "https://x.com/fishkeepinglife",
          "https://www.facebook.com/FishKeepingLifeCo",
          "https://www.threads.net/@fishkeepinglifeco",
          "https://www.reddit.com/u/FishKeepingLifeCo"
        ]
      },
      {
        "@type": "WebSite",
        "@id": "https://thetankguide.com/#website",
        "url": "https://thetankguide.com/",
        "name": "The Tank Guide",
        "description": "The Tank Guide is an educational aquarium website from FishKeepingLifeCo, offering tools, guides, and beginner friendly resources.",
        "publisher": { "@id": "https://thetankguide.com/#organization" },
        "inLanguage": "en-US",
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://thetankguide.com/search?q={search_term_string}"
          },
          "query-input": {
            "@type": "PropertyValueSpecification",
            "valueRequired": true,
            "valueName": "search_term_string"
          }
        }
      },
      {
        "@type": "WebPage",
        "@id": "https://thetankguide.com/journal.html",
        "url": "https://thetankguide.com/journal.html",
        "name": "FishKeepingLifeCo Journal — Real Aquarium Logs and Water Change History | The Tank Guide",
        "description": "Follow real aquarium logs from FishKeepingLifeCo home tanks, including water testing, maintenance, and livestock changes that inform The Tank Guide tools and Daily Tank Journals.",
        "inLanguage": "en-US",
        "isPartOf": { "@id": "https://thetankguide.com/#website" },
        "publisher": { "@id": "https://thetankguide.com/#organization" },
        "author": { "@id": "https://thetankguide.com/#organization" }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://thetankguide.com/journal.html#breadcrumb",
        "itemListElement": [
          { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://thetankguide.com/" },
          { "@type": "ListItem", "position": 2, "name": "FishKeepingLifeCo Journal", "item": "https://thetankguide.com/journal.html" }
        ]
      }
    ]
  }
  </script>
<!-- === TTG CMP Consent Bridge START === -->
<script>
(function(){
  // Helper: map TCF consent to our single "ads granted" flag.
  // We consider "granted" only when Purpose 1 (storage) AND Purpose 4 (select personalised ads)
  // are consented. If you want to allow NON-personalised ads when only Purpose 1 is granted,
  // set allowNPA=true below.
  var allowNPA = true; // if true, we’ll treat Purpose 1 only as "granted" for showing slots (Google will serve NPA ads).

  function setAdConsent(granted){
    // Google CMP interface (Funding Choices) — set consent for ads_storage and ad_user_data
    var consentState = granted ? 'granted' : 'denied';
    var payload = {
      'ad_storage': consentState,
      'ad_user_data': consentState,
      'ad_personalization': consentState
    };
    if (typeof window.__ttgUpdateConsentState__ === 'function') {
      window.__ttgUpdateConsentState__(payload);
    } else if (typeof window.gtag === 'function') {
      window.gtag('consent', 'update', payload);
    } else {
      (window.__ttgDeferredConsentUpdates__ = window.__ttgDeferredConsentUpdates__ || []).push(payload);
    }
  }

  function hookTCF(){
    // Funding Choices exposes the IAB TCF v2 interface.
    // We hook into it to map Purpose consent to Google consent mode.
    if (typeof __tcfapi !== 'function') return;

    __tcfapi('addEventListener', 2, function(tcData, success){
      if(!success || !tcData || tcData.eventStatus !== 'tcloaded') return;

      // Purpose IDs: 1 = Storage and Access, 4 = Select Personalised Ads
      var p1 = tcData.purpose && tcData.purpose.consents ? tcData.purpose.consents[1] : false;
      var p4 = tcData.purpose && tcData.purpose.consents ? tcData.purpose.consents[4] : false;

      var granted = allowNPA ? (p1 && (p4 || true)) : (p1 && p4);
      setAdConsent(granted);
    });
  }

  // Initialize once Funding Choices loads the TCF stub
  if (typeof __tcfapi === 'function') {
    hookTCF();
  } else {
    window.addEventListener('tcfapiReady', hookTCF, { once: true });
  }
})();
</script>
<!-- === TTG CMP Consent Bridge END === -->
</body>
</html>
