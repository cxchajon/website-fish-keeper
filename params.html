<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cycling Coach &amp; 24-Hour Challenge — The Tank Guide</title>
  <meta
    name="description"
    content="Track ammonia, nitrite, and nitrate readings with The Tank Guide Cycling Coach and follow the 24-Hour Challenge for safe fishkeeping."
  />
  <link rel="canonical" href="https://thetankguide.com/params.html">
  <link rel="stylesheet" href="css/style.css?v=1.0.9" />
  <link rel="stylesheet" href="/assets/css/utilities.css?v=2025-11-07" />
  <link rel="icon" href="/favicon.ico" />
  <script defer src="js/nav.js?v=1.1.0"></script>
  <style>
    :root {
      --card-surface: rgba(14, 22, 36, 0.72);
      --card-border: rgba(255, 255, 255, 0.16);
      --muted: rgba(240, 246, 255, 0.78);
      --input-bg: rgba(8, 12, 20, 0.6);
      --input-border: rgba(255, 255, 255, 0.18);
      --chip-warn: rgba(245, 179, 1, 0.18);
      --chip-warn-text: #ffe8b5;
      --chip-warn-border: rgba(245, 179, 1, 0.4);
      --chip-plain: rgba(255, 255, 255, 0.08);
      --transition-speed: 220ms;
    }

    body.cycling-coach {
      position: relative;
      min-height: 100vh;
      padding-bottom: 120px;
    }

    .planted-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: linear-gradient(160deg, rgba(46, 140, 90, 0.3), rgba(46, 140, 90, 0.16));
      opacity: 0;
      transition: opacity var(--transition-speed) ease;
      z-index: 0;
    }

    body.planted-active .planted-overlay {
      opacity: 1;
    }

    @media (prefers-reduced-motion: reduce) {
      .planted-overlay,
      .page-title__leaf {
        transition-duration: 0ms;
      }
    }

    #site-nav {
      position: relative;
      z-index: 20;
    }

    main {
      position: relative;
      z-index: 10;
      padding: 32px 20px 64px;
    }

    .page-wrap {
      width: min(960px, 100%);
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 28px;
    }

    .page-header {
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .page-header p {
      margin: 0;
      color: var(--muted);
    }

    .page-title {
      margin: 0;
      font-size: clamp(2.4rem, 3vw + 1.6rem, 3rem);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .page-title__leaf {
      opacity: 0;
      transform: translateY(-6px);
      transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease;
      font-size: 1.4rem;
    }

    body.planted-active .page-title__leaf {
      opacity: 1;
      transform: translateY(0);
    }

    .card {
      background: var(--card-surface);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      padding: 24px;
      backdrop-filter: blur(18px) saturate(1.4);
      -webkit-backdrop-filter: blur(18px) saturate(1.4);
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .card__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .card__title {
      margin: 0;
      font-size: 1.3rem;
    }

    .info-btn {
      --info-btn-hit: 44px;
      --info-btn-visible: 30px;
      --info-btn-bg: var(--chip-plain);
      --info-btn-bg-hover: rgba(255, 255, 255, 0.16);
      --info-btn-bg-active: rgba(255, 255, 255, 0.12);
      --info-btn-border: var(--card-border);
      --info-btn-border-hover: rgba(255, 255, 255, 0.26);
      --info-btn-border-active: rgba(255, 255, 255, 0.22);
      --info-btn-focus: #8cc4ff;
      --info-btn-icon: inherit;
      font-size: 0.92rem;
    }

    .info-btn + .ttg-tooltip {
      opacity: 0;
      transform: translateY(-4px);
      transition: opacity 140ms ease, transform 140ms ease;
    }

    .info-btn.is-open + .ttg-tooltip {
      opacity: 1;
      transform: translateY(0);
    }

    .form-grid {
      display: grid;
      gap: 18px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .field label {
      font-weight: 600;
      font-size: 0.98rem;
    }

    .field input[type="number"],
    .field select {
      width: 100%;
      padding: 12px 12px;
      border-radius: 10px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: inherit;
      font-size: 1rem;
    }

    .field input[type="number"]:focus-visible,
    .field select:focus-visible,
    .checkbox input:focus-visible {
      outline: 2px solid #8cc4ff;
      outline-offset: 2px;
    }

    .checkbox {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
    }

    .checkbox input {
      width: 20px;
      height: 20px;
    }

    .form-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: flex-start;
    }

    .btn {
      appearance: none;
      border-radius: 12px;
      border: 1px solid transparent;
      padding: 12px 22px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      color: #06121e;
      background: #f3f7ff;
      transition: transform 160ms ease, box-shadow 160ms ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(3, 10, 22, 0.35);
    }

    .btn:focus-visible {
      outline: 3px solid #8cc4ff;
      outline-offset: 2px;
    }

    .btn--secondary {
      background: transparent;
      border-color: rgba(255, 255, 255, 0.28);
      color: inherit;
      box-shadow: none;
    }

    .status-row {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .status-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      align-self: flex-start;
      font-weight: 700;
      letter-spacing: 0.01em;
      padding: 10px 16px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.16);
    }

    .results-summary {
      margin: 0;
      color: var(--muted);
      font-size: 0.98rem;
    }

    .actions-block {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .actions-block header {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
    }

    .actions-list {
      margin: 0;
      padding-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .actions-list li {
      line-height: 1.45;
    }

    .challenge-card {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .challenge-card h3 {
      margin: 0;
      font-size: 1.15rem;
    }

    .challenge-grid {
      display: grid;
      gap: 14px;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    .chip-note {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--chip-warn);
      color: var(--chip-warn-text);
      border: 1px solid var(--chip-warn-border);
      border-radius: 999px;
      padding: 8px 14px;
      font-weight: 600;
    }

    details.advanced {
      border: 1px solid rgba(255, 255, 255, 0.18);
      border-radius: 14px;
      padding: 0;
      background: rgba(10, 16, 28, 0.6);
      overflow: hidden;
    }

    details.advanced > summary {
      list-style: none;
      margin: 0;
      padding: 18px 20px;
      font-weight: 600;
      font-size: 1.05rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    details.advanced > summary::-webkit-details-marker {
      display: none;
    }

    .advanced-body {
      padding: 0 20px 20px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .advanced-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    .temp-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .temp-toggle button {
      appearance: none;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.24);
      background: transparent;
      color: inherit;
      padding: 8px 12px;
      font-weight: 600;
      cursor: pointer;
    }

    .temp-toggle button:focus-visible {
      outline: 2px solid #8cc4ff;
      outline-offset: 2px;
    }

    .advanced-output {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      font-weight: 600;
    }

    .advanced-output .value {
      font-variant-numeric: tabular-nums;
    }

    .nh3-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(226, 85, 85, 0.18);
      border: 1px solid rgba(226, 85, 85, 0.46);
      color: #ffe3e3;
      font-size: 0.85rem;
    }

    .advanced-note {
      margin: 0;
      font-size: 0.95rem;
      color: var(--muted);
    }

    .advanced-note a {
      color: inherit;
    }

    footer {
      margin-top: 40px;
    }

    @media (max-width: 640px) {
      .card {
        padding: 20px;
      }
    }
  </style>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "@id": "https://thetankguide.com/#organization",
  "name": "FishKeepingLifeCo",
  "alternateName": "The Tank Guide",
  "url": "https://thetankguide.com",
  "addressCountry": "US",
  "addressRegion": "NY",
  "logo": "https://thetankguide.com/logo.png",
  "image": "https://thetankguide.com/logo.png",
  "slogan": "Educational Aquarium Books & Tools",
  "description": "FishKeepingLifeCo publishes educational aquarium books and interactive online tools like The Tank Guide to help aquarists of all experience levels set up, stock, and maintain thriving aquariums.",
  "brand": {
    "@type": "Brand",
    "name": "The Tank Guide"
  },
  "foundingDate": "2025-09-12",
  "publishingPrinciples": "https://thetankguide.com/about.html",
  "areaServed": ["United States", "New York"],
  "knowsAbout": [
    "Aquariums",
    "Fishkeeping",
    "Nitrogen Cycle",
    "Freshwater Aquariums",
    "Planted Tanks",
    "Aquarium Setup Basics",
    "Water Parameters",
    "Aquarium Cycling"
  ],
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "contactType": "customer support",
      "email": "info@thetankguide.com",
      "availableLanguage": ["en"]
    }
  ],
  "sameAs": [
    "https://www.instagram.com/FishKeepingLifeCo",
    "https://www.tiktok.com/@FishKeepingLifeCo",
    "https://www.facebook.com/fishkeepinglifeco",
    "https://x.com/fishkeepinglife?s=21",
    "https://www.youtube.com/@fishkeepinglifeco",
    "https://amzn.to/3IRKvK0"
  ]
}
  </script>
  <!-- Consent Mode defaults (load FIRST) -->
  <script src="/assets/js/consent-mode.js" defer></script>
  <!-- Google tag (gtag.js) — GA4 -->
  <!--#include virtual="/includes/ga4.html" -->

  <!-- AdSense loader (keep one global instance only) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9905718149811880"
    crossorigin="anonymous"></script>
  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token": "YOUR_CLOUDFLARE_TOKEN"}'></script>
  <!-- End Cloudflare Web Analytics -->
  <!-- --- Google CMP (Funding Choices) START --- -->
  <script async src="https://fundingchoicesmessages.google.com/i/pub-9905718149811880?ers=1"></script>
  <script>
    // Required bootstrap per Google; signals CMP presence
    (function() {
      function signalGooglefcPresent() {
        if (!window.frames['googlefcPresent']) {
          if (document.body) {
            const iframe = document.createElement('iframe');
            iframe.style.cssText = 'display:none';
            iframe.name = 'googlefcPresent';
            document.body.appendChild(iframe);
          } else {
            setTimeout(signalGooglefcPresent, 0);
          }
        }
      }
      signalGooglefcPresent();
    })();
  </script>
  <!-- --- Google CMP (Funding Choices) END --- -->
</head>
<body class="theme-dark cycling-coach">
  <div id="site-nav"></div>
  <div class="planted-overlay" aria-hidden="true"></div>

  <main id="main-content">
    <div class="page-wrap" id="cycling-coach">
      <section id="cc-title" class="cc-title" aria-label="Cycling Coach header">
        <h1 class="cc-title__h1">
          Cycling Coach &amp; 24-Hour Challenge
          <span class="cc-title__leaf" aria-hidden="true"></span>
        </h1>
        <div class="cc-title__eyebrow">Nitrogen cycle tool</div>
        <p class="cc-title__subline">Enter today’s readings for a clear snapshot.</p>
      </section>

      <!-- === TTG_ParamsTop (under hero/blurb) === -->
      <div class="ttg-adunit ttg-adunit--top" id="ad-top-params" aria-label="Advertisement">
        <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-9905718149811880"
          data-ad-slot="8136808291"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <section class="card" aria-labelledby="inputs-heading">
        <div class="card__header">
          <h2 class="card__title" id="inputs-heading">Inputs</h2>
        </div>
        <form id="coach-form" novalidate data-testid="coach-form">
          <div class="form-grid">
            <div class="field">
              <div class="label-row">
                <label for="ammonia">Ammonia (NH₃/NH₄⁺)</label>
                <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Ammonia" aria-expanded="false" data-tooltip-id="tt-ammonia" aria-controls="tt-ammonia" data-testid="info-ammonia">i</button>
              </div>
              <input type="number" id="ammonia" name="ammonia" step="0.01" min="0" inputmode="decimal" data-testid="ammonia" />
              <div id="tt-ammonia" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Waste from fish/food. Even tiny amounts are toxic.</div>
            </div>
            <div class="field">
              <div class="label-row">
                <label for="nitrite">Nitrite (NO₂⁻)</label>
                <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Nitrite" aria-expanded="false" data-tooltip-id="tt-nitrite" aria-controls="tt-nitrite" data-testid="info-nitrite">i</button>
              </div>
              <input type="number" id="nitrite" name="nitrite" step="0.01" min="0" inputmode="decimal" data-testid="nitrite" />
              <div id="tt-nitrite" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Mid-stage of the cycle; also toxic.</div>
            </div>
            <div class="field">
              <div class="label-row">
                <label for="nitrate">Nitrate (NO₃⁻)</label>
                <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Nitrate" aria-expanded="false" data-tooltip-id="tt-nitrate" aria-controls="tt-nitrate" data-testid="info-nitrate">i</button>
              </div>
              <input type="number" id="nitrate" name="nitrate" step="0.1" min="0" inputmode="decimal" data-testid="nitrate" />
              <div id="tt-nitrate" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>End product; safer but must be controlled with water changes.</div>
            </div>
            <div class="field">
              <div class="label-row">
                <label for="cycle-method">Cycle Method</label>
                <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Cycle Method" aria-expanded="false" data-tooltip-id="tt-method" aria-controls="tt-method" data-testid="info-cycle-method">i</button>
              </div>
              <select id="cycle-method" name="cycle-method">
                <option value="fishless" selected>Fishless</option>
                <option value="fish-in">Fish-in</option>
              </select>
              <div id="tt-method" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Fishless equals adding ammonia without fish. Fish-in means cycling with fish and requires extra care.</div>
            </div>
            <div id="planted-row" class="planted-row">
              <label class="planted-checkbox">
                <input type="checkbox" id="planted" name="planted">
                <span class="checkmark"></span>
                This is a planted tank.
              </label>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn" id="check-button">Check</button>
            <button type="button" class="btn btn--secondary" id="clear-button">Clear</button>
          </div>
        </form>
      </section>

      <section class="card" aria-labelledby="results-heading">
        <div class="card__header">
          <div class="status-label">
            <h2 class="card__title" id="results-heading">Results</h2>
            <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Results status" aria-expanded="false" data-tooltip-id="tt-status" aria-controls="tt-status" data-testid="info-status">i</button>
          </div>
          <div id="tt-status" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>High-level snapshot of where your tank stands.</div>
        </div>
        <div class="status-row" aria-live="polite" data-testid="result-status">
          <span class="status-badge" id="status-badge">⚪ Incomplete</span>
          <p class="results-summary" id="results-summary">Ammonia: — ppm • Nitrite: — ppm • Nitrate: — ppm • Method: Fishless • Planted: No</p>
        </div>
        <div class="actions-block" id="actions-block" hidden data-testid="result-actions">
          <header>
            <span>Action steps</span>
            <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about Action steps" aria-expanded="false" data-tooltip-id="tt-actions" aria-controls="tt-actions" data-testid="info-actions">i</button>
          </header>
          <div id="tt-actions" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Quick, practical steps based on your readings.</div>
          <ul class="actions-list" id="actions-list"></ul>
        </div>
      </section>

      <!-- === TTG_ParamsBottom (post-results, before educational blurb) === -->
      <div class="ttg-adunit ttg-adunit--bottom" id="ad-bottom-params" aria-label="Advertisement">
        <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-9905718149811880"
          data-ad-slot="5754828160"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <section class="card" id="challengeCard" aria-labelledby="challenge-heading" hidden>
        <div class="card__header">
          <h2 class="card__title" id="challenge-heading">24-Hour Challenge</h2>
          <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about the Challenge" aria-expanded="false" data-tooltip-id="tt-challenge" aria-controls="tt-challenge" data-testid="info-challenge">i</button>
          <div id="tt-challenge" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Shows your filter can process two ppm ammonia to zero ammonia and zero nitrite in twenty-four hours.</div>
        </div>
        <div class="challenge-card">
          <p class="challenge-instructions" id="challengeInstruction">Dose to ~2 ppm, wait 24 hours, then enter the readings below.</p>
          <button type="button" class="btn" id="challenge-start">Start 24-Hour Challenge</button>
          <div class="challenge-grid" id="challenge-form" hidden>
            <div class="field">
              <label for="challengeAmmonia">Ammonia after 24h</label>
              <input type="number" id="challengeAmmonia" step="0.01" min="0" inputmode="decimal" />
              <p class="field-error" id="challenge-ammonia-error" hidden></p>
            </div>
            <div class="field">
              <label for="challengeNitrite">Nitrite after 24h</label>
              <input type="number" id="challengeNitrite" step="0.01" min="0" inputmode="decimal" />
              <p class="field-error" id="challenge-nitrite-error" hidden></p>
            </div>
          </div>
          <button type="button" class="btn" id="challenge-check" hidden>Check results</button>
          <div id="challengeMessage"></div>
          <div class="actions-block" id="challenge-results" hidden>
            <header>
              <span>Challenge test</span>
              <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about the Challenge test" aria-expanded="false" data-tooltip-id="tt-challenge-inline" aria-controls="tt-challenge-inline" data-testid="info-challenge-inline">i</button>
            </header>
            <div id="tt-challenge-inline" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Shows your filter can process two ppm ammonia to zero ammonia and zero nitrite in twenty-four hours.</div>
            <ul class="actions-list" id="challenge-list"></ul>
          </div>
        </div>
      </section>

      <details class="advanced" id="advanced-panel">
        <summary aria-controls="advanced-content" aria-expanded="false">Advanced (optional)</summary>
        <div class="advanced-body" id="advanced-content">
          <div class="advanced-grid">
            <div class="field">
              <label for="ph">pH</label>
              <input type="number" id="ph" name="ph" step="0.1" inputmode="decimal" data-testid="ph" />
            </div>
            <div class="field">
              <label for="temperature">Temperature</label>
              <div class="temp-toggle">
                <input type="number" id="temperature" name="temperature" step="0.1" inputmode="decimal" data-testid="temp" />
                <button type="button" id="temp-toggle" aria-label="Switch temperature unit">°F</button>
              </div>
            </div>
          </div>
          <div class="advanced-output" aria-live="polite">
            <span>Estimated toxic NH₃:</span>
            <span class="value" id="nh3-value">—</span>
            <span class="nh3-badge" id="nh3-badge" hidden>⚠️ Caution</span>
            <button type="button" class="info-btn ttg-tooltip-trigger" aria-label="More info about toxic NH3 estimate" aria-expanded="false" data-tooltip-id="tt-advanced" aria-controls="tt-advanced" data-testid="info-advanced">i</button>
            <div id="tt-advanced" class="ttg-tooltip" data-tooltip-panel role="tooltip" hidden>Test kits read TAN, which is NH3 plus NH4. Only NH3 is toxic and increases with pH and temperature.</div>
          </div>
          <p class="advanced-note"><a href="/media.html" target="_blank" rel="noopener">See Media page for Sources &amp; Further Reading.</a></p>
        </div>
      </details>

      <section id="cc-bottom" class="cc-bottom" aria-label="About Cycling Coach">
        <p class="home-subtext cc-disclaimer">Cycling Coach is an educational tool. Always confirm with your own testing and judgment before making aquarium decisions.</p>
        <p class="home-blurb cc-seo">Cycling Coach is your aquarium cycling assistant. Enter your test results for ammonia (NH₃/NH₄⁺), nitrite (NO₂⁻), and nitrate (NO₃⁻) to see how your tank is progressing through the nitrogen cycle. Whether you’re doing a fishless cycle or cycling with fish, the tool helps you track water parameters, understand the next steps, and maintain a safe environment for your fish.</p>
      </section>
    </div>
  </main>
<script type="module" src="js/params.js?v=2.0.0"></script>
<!-- === TTG Cookie Consent START === -->
<div id="ttg-consent" class="ttg-consent" data-consent-banner>
  <div class="ttg-consent__inner" role="dialog" aria-labelledby="ttg-consent-title" aria-describedby="ttg-consent-desc">
    <h3 id="ttg-consent-title">Cookies & Advertising</h3>
    <p id="ttg-consent-desc">
      We use cookies to run this site and (if you allow) to show relevant ads from Google AdSense. You can accept all cookies, reject personalized ads, or manage preferences anytime.
    </p>
    <div class="ttg-consent__actions">
      <button type="button" class="ttg-btn ttg-btn--secondary js-consent-reject" id="ttg-consent-reject">Reject (Non-personalized)</button>
      <button type="button" class="ttg-btn ttg-btn--ghost" id="ttg-consent-manage">Manage</button>
      <button type="button" class="ttg-btn ttg-btn--primary js-consent-accept" id="ttg-consent-accept">Accept All</button>
    </div>
  </div>
</div>

<div id="ttg-consent-modal" class="ttg-consent-modal" hidden aria-modal="true" role="dialog" aria-labelledby="ttg-consent-modal-title">
  <div class="ttg-consent-modal__panel">
    <h3 id="ttg-consent-modal-title">Cookie Preferences</h3>
    <form id="ttg-consent-form">
      <label class="ttg-row">
        <input type="checkbox" checked disabled />
        <span><strong>Essential</strong> — required for core site functions.</span>
      </label>
      <label class="ttg-row">
        <input type="checkbox" id="ttg-c-analytics" />
        <span><strong>Analytics</strong> — understand usage (if enabled later).</span>
      </label>
      <label class="ttg-row">
        <input type="checkbox" id="ttg-c-ads" />
        <span><strong>Advertising</strong> — allow personalized ads (Google AdSense).</span>
      </label>
      <div class="ttg-consent-modal__actions">
        <button type="button" class="ttg-btn ttg-btn--ghost" id="ttg-consent-cancel">Cancel</button>
        <button type="submit" class="ttg-btn ttg-btn--primary">Save Preferences</button>
      </div>
    </form>
  </div>
</div>

<!-- === TTG Consent Banner Controller START === -->
  <script defer src="/assets/js/consent-banner.js"></script>
<!-- === TTG Consent Banner Controller END === -->


<!-- === TTG CMP Consent Bridge START === -->
<script>
(function(){
  // Helper: map TCF consent to our single "ads granted" flag.
  // We consider "granted" only when Purpose 1 (storage) AND Purpose 4 (select personalised ads)
  // are consented. If you want to allow NON-personalised ads when only Purpose 1 is granted,
  // set allowNPA=true below.
  var allowNPA = true; // if true, we’ll treat Purpose 1 only as "granted" for showing slots (Google will serve NPA ads).

  function setAdConsent(granted){
    document.documentElement.setAttribute('data-ad-consent', granted ? 'granted' : 'denied');
    document.documentElement.classList.toggle('is-ads-disabled', !granted);
    window.__TTG_ADS_DISABLED__ = !granted;
    // Inform any listeners (our ad loader later)
    window.dispatchEvent(new CustomEvent('ttg:consent-change', {detail:{granted}}));
  }

  // If Google CMP is present, it defines __tcfapi.
  function hookTCF(){
    if (typeof window.__tcfapi !== 'function') return false;

    // Hide our local cookie banner when Google CMP is running (EEA users).
    try{
      var banner = document.getElementById('ttg-consent');
      var modal  = document.getElementById('ttg-consent-modal');
      if (banner){ banner.hidden = true; banner.classList.remove('is-open'); }
      if (modal)  modal.hidden  = true;
    }catch(e){}

    // Listen for consent changes
    window.__tcfapi('addEventListener', 2, function(tcData, ok){
      if(!ok || !tcData) return;
      // Purpose 1 = storage; Purpose 4 = personalised ads
      var p = (tcData.purpose && tcData.purpose.consents) || {};
      var hasP1 = !!p[1];
      var hasP4 = !!p[4];

      var granted = allowNPA ? hasP1 : (hasP1 && hasP4);
      setAdConsent(granted);
    });

    // Also fetch current state once
    window.__tcfapi('getTCData', 2, function(tcData, ok){
      if(!ok || !tcData) return;
      var p = (tcData.purpose && tcData.purpose.consents) || {};
      var hasP1 = !!p[1];
      var hasP4 = !!p[4];
      var granted = allowNPA ? hasP1 : (hasP1 && hasP4);
      setAdConsent(granted);
    });

    return true;
  }

  // Try to hook immediately; if CMP loads a bit later, poll briefly
  if (!hookTCF()){
    var tries = 0, t = setInterval(function(){
      tries++;
      if (hookTCF() || tries > 40) clearInterval(t); // up to ~4s
    }, 100);
  }

  // Fallback for non-EEA visitors (no __tcfapi): keep using our local preference
  // Our existing local banner writes ttgConsentV2 with {ads:true|false}.
  // If CMP absent, keep existing behavior (do not force-show anything here).

})();
</script>
<!-- === TTG CMP Consent Bridge END === -->

<!-- === TTG Cookie Consent END === -->

<!-- === TTG Ad Slot View Tracking START === -->
<script src="/js/ad-slot-view-tracking.js"></script>
<!-- === TTG Ad Slot View Tracking END === -->

  <script src="/js/footer-loader.js?v=1.4.5" defer></script>
  <div id="site-footer" data-footer-src="/footer.html?v=1.4.5"></div>
</body>
</html>
