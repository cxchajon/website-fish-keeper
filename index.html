<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Stocking Calculator • FishkeepingLifeCo</title>
<style>
  :root{
    --gap:12px; --radius:14px;
    --ink:#0f172a; --muted:#475569;
    --brand:#0284c7; --ok:#10b981; --warn:#f59e0b; --bad:#ef4444;
    --g1:#0ea5e9; --g2:#38bdf8; --g3:#7dd3fc;
    --card:rgba(224,242,254,0.92); --card-border:rgba(15,23,42,0.06);
    --field-bd:#d2dbe6;
  }
  *{box-sizing:border-box}
  body{margin:0;color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
       background:linear-gradient(180deg,var(--g1) 0%,var(--g2) 60%,var(--g3) 100%);background-attachment:fixed}
  .wrap{max-width:1100px;margin:0 auto;padding:28px 20px 72px}

  .brand{color:#fff;margin-bottom:8px}
  .brand-name{font-weight:800;font-size:1.6rem}

  .card{background:var(--card);border:1px solid var(--card-border);border-radius:14px;padding:20px;margin-bottom:20px}
  .card h2{margin:0 0 10px;font-weight:800}

  label{font-weight:700;margin-bottom:6px;display:block}
  input,select{width:100%;padding:10px 12px;border:1px solid var(--field-bd);border-radius:10px;background:#fff}
  .row{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));align-items:end}

  table.stock{width:100%;border-collapse:separate;border-spacing:0 6px}
  thead th{padding:8px 6px 10px;text-align:left;border-bottom:1px solid #cfe7fb66}
  thead th.qty{text-align:center;width:90px}
  thead th.actions{text-align:right;width:200px}
  tbody tr{background:#fff;border:1px solid #e7f1fb}
  tbody td{padding:12px 10px;vertical-align:middle}

  .btn{border:none;color:#fff;background:var(--brand);padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer}
  #reset{background:var(--bad)}

  /* bars */
  .bar{height:22px;background:#e2e8f0;border-radius:999px;overflow:hidden}
  .bar-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--ok),var(--warn),var(--bad));transition:width .25s ease}

  /* status strip */
  #diag{position:sticky;top:0;z-index:9999;display:none}
  #diag>div{padding:8px 12px;font:12px/1.2 ui-sans-serif,system-ui}
  #diag.ok{display:block;background:#ecfdf5;color:#065f46;border-bottom:2px solid #a7f3d0}
  #diag.err{display:block;background:#fee2e2;color:#7f1d1d;border-bottom:2px solid #fecaca}
</style>
</head>
<body>
  <div id="diag"><div></div></div>

  <div class="wrap">
    <div class="brand">
      <div class="brand-name">FishkeepingLifeCo</div>
      <div>Aquarium Education</div>
    </div>

    <section class="card">
      <h2>Tank Setup</h2>
      <div class="row">
        <div>
          <label for="gallons">Tank size (US gallons)</label>
          <input id="gallons" type="number" min="1" value="20">
        </div>
        <div>
          <label for="filtration">Filtration</label>
          <select id="filtration">
            <option value="low">Low — Sponge filter</option>
            <option value="standard" selected>Standard — HOB</option>
            <option value="high">High — Sump/Canister</option>
          </select>
        </div>
        <div>
          <label>Planted?</label>
          <input id="planted" type="checkbox"> <span>Yes</span>
        </div>
      </div>

      <div style="margin-top:16px">
        <h3>Bioload</h3>
        <div class="bar"><div id="bioBarFill" class="bar-fill"></div></div>
        <small>Bioload is an estimate. Filtration and plants adjust capacity.</small>

        <h3 style="margin-top:14px">Aggression Risk (Average conflicts)</h3>
        <div class="bar"><div id="aggBarFill" class="bar-fill"></div></div>
        <small>Serious conflicts automatically max this bar.</small>
      </div>
    </section>

    <section class="card">
      <h2>Add Fish</h2>
      <div class="row">
        <div>
          <label for="fishSearch">Search species</label>
          <input id="fishSearch" type="text" placeholder="Type to filter the list" autocomplete="off" autocapitalize="none">
        </div>
      </div>
      <div class="row">
        <div>
          <label for="fishSelect">Species</label>
          <select id="fishSelect"></select>
        </div>
      </div>
      <div class="row">
        <div>
          <label for="recMin">Recommended minimum</label>
          <input id="recMin" type="number" value="" disabled>
        </div>
      </div>
      <div class="row">
        <div>
          <label for="fQty">Quantity</label>
          <input id="fQty" type="number" min="1" step="1" inputmode="numeric" pattern="[0-9]*" placeholder="e.g., 12">
        </div>
        <div><button id="addFish" class="btn" type="button">Add</button></div>
      </div>
      <small>If Quantity is empty/invalid, we’ll use the Recommended minimum (or 1). Your typed number is never overwritten.</small>
    </section>

    <section class="card">
      <h2>Current Stock</h2>
      <table class="stock">
        <thead>
          <tr><th>Name</th><th class="qty">Qty</th><th class="actions">Actions</th></tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
      <div class="row" style="margin-top:10px">
        <div><button id="reset" class="btn" type="button">Clear Stock</button></div>
      </div>
    </section>

    <section class="card">
      <h2>Aggression & Compatibility Warnings</h2>
      <div id="aggression-warnings"></div>
    </section>
  </div>

  <footer style="text-align:center;color:#0b3553;padding:14px 0 28px;font-weight:700">
    FishkeepingLifeCo • Build <strong id="appVersion">v9.3.0</strong> • Updated Sep 19, 2025
  </footer>

  <!-- Keep only the data + aggression libs. DO NOT include legacy stocking_advisor.js -->
  <script src="js/fish-data.js" defer></script>
  <script src="js/aggression.js" defer></script>

  <!-- Our modular app -->
  <script type="module" src="js/modules/app.js?v=9.3.0"></script>
</body>
</html>