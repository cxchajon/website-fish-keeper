<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stocking Advisor Prototype — Optimize Aquarium Plans | The Tank Guide</title>
  <meta name="description" content="Explore the prototype experience for The Tank Guide Stocking Advisor, including metadata, structured data, and educational copy tuned for SEO, AEO, GEO, and AdSense validation." />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0a1020" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png" />
  <link rel="canonical" href="https://thetankguide.com/prototype/stocking-prototype.html" />
  <meta property="og:type" content="article" />
  <meta property="og:site_name" content="The Tank Guide" />
  <meta property="og:title" content="Stocking Advisor Prototype — Optimize Aquarium Plans | The Tank Guide" />
  <meta property="og:description" content="Preview the optimized Stocking Advisor experience with refreshed metadata, structured data, and guidance for balanced freshwater aquariums." />
  <meta property="og:url" content="https://thetankguide.com/prototype/stocking-prototype.html" />
  <meta property="og:image" content="https://thetankguide.com/assets/og/stocking-advisor-og.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Screenshot of The Tank Guide Stocking Advisor interface highlighting tank planning insights." />
  <meta property="article:published_time" content="2024-11-18T09:00:00-05:00" />
  <meta property="article:modified_time" content="2025-01-12T10:15:00-05:00" />
  <meta property="article:section" content="Aquarium Planning" />
  <meta property="article:tag" content="aquarium stocking" />
  <meta property="article:tag" content="fish tank planner" />
  <meta property="article:tag" content="freshwater compatibility" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@fishkeepinglife" />
  <meta name="twitter:title" content="Stocking Advisor Prototype — Optimize Aquarium Plans | The Tank Guide" />
  <meta name="twitter:description" content="See the SEO and structured data prototype for the Stocking Advisor before it ships to the live stocking page." />
  <meta name="twitter:image" content="https://thetankguide.com/assets/og/stocking-advisor-og.png" />
  <meta name="twitter:image:alt" content="Stocking Advisor dashboard preview with fish compatibility insights." />
  <meta name="twitter:creator" content="@fishkeepinglife" />
  <link rel="stylesheet" id="css-main" href="/css/style.css?v=2024-06-05a" />
  <link rel="stylesheet" href="/assets/css/utilities.css?v=2025-11-07" />
  <link rel="stylesheet" href="/css/site.css?v=1.4.8" />
  <link rel="stylesheet" href="/css/ui.css?v=2024-09-15" />
  <link rel="stylesheet" href="/prototype/css/stocking-prototype.css" />
  <link rel="stylesheet" href="/prototype/assets/css/proto-popovers.css?v=proto_rm_2025_10_25" />
  <link rel="stylesheet" href="/prototype/assets/css/filtration.css?v=proto_rm_2025_10_25" />
  <link rel="stylesheet" href="/prototype/assets/css/prototype.css?v=proto_rm_2025_10_25" />
  <style>
    /* PROTOTYPE ONLY — block any lingering legacy UI from appearing */
    .filtration-card,
    .filtration-summary,
    .filter-setup-legacy,
    .filter-rows,
    .filter-row,
    .add-another-filter,
    .total-flow,
    .turnover,
    #filtration-summary,
    [data-card="filtration-summary"],
    #filtration-trigger {
      display: none !important;
    }
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Organization",
        "@id": "https://thetankguide.com/#organization",
        "name": "The Tank Guide",
        "url": "https://thetankguide.com/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://thetankguide.com/logo.png",
          "width": 512,
          "height": 512
        },
        "sameAs": [
          "https://www.youtube.com/@TheTankGuide",
          "https://www.instagram.com/fishkeepinglife/",
          "https://www.facebook.com/fishkeepinglife",
          "https://www.tiktok.com/@fishkeepinglife"
        ]
      },
      {
        "@type": "WebApplication",
        "@id": "https://thetankguide.com/prototype/stocking-prototype.html#webapp",
        "name": "Stocking Advisor Prototype",
        "url": "https://thetankguide.com/prototype/stocking-prototype.html",
        "applicationCategory": "LifestyleApplication",
        "operatingSystem": "Web",
        "description": "Prototype environment for The Tank Guide Stocking Advisor, providing aquarium stocking suggestions, bioload guidance, and parameter targets.",
        "image": "https://thetankguide.com/assets/og/stocking-advisor-og.png",
        "author": {
          "@id": "https://thetankguide.com/#organization"
        },
        "publisher": {
          "@id": "https://thetankguide.com/#organization"
        }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://thetankguide.com/prototype/stocking-prototype.html#breadcrumb",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://thetankguide.com/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Stocking Advisor Prototype",
            "item": "https://thetankguide.com/prototype/stocking-prototype.html"
          }
        ]
      },
      {
        "@type": "FAQPage",
        "@id": "https://thetankguide.com/prototype/stocking-prototype.html#faq",
        "url": "https://thetankguide.com/prototype/stocking-prototype.html",
        "mainEntity": [
          {
            "@type": "Question",
            "@id": "https://thetankguide.com/prototype/stocking-prototype.html#faq-tank-size",
            "name": "How accurate are the tank size recommendations?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "The advisor uses a balanced approach that considers species behavior, activity level, and conservative new-tank assumptions. It avoids rigid “rules” and instead provides conservative starting points so aquarists can fine-tune their stocking levels through regular testing and observation."
            }
          },
          {
            "@type": "Question",
            "@id": "https://thetankguide.com/prototype/stocking-prototype.html#faq-plants",
            "name": "Why don’t plants change capacity here?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "This tool is a new-tank walkthrough. Fresh setups don’t have established plant mass or stable growth, so we don’t count a plant bonus. After your tank cycles and plants are thriving, your effective capacity may improve. That’s why we recommend regular water testing (ammonia, nitrite, nitrate, pH, KH/GH) and rechecking your plan as the tank matures."
            }
          },
          {
            "@type": "Question",
            "@id": "https://thetankguide.com/prototype/stocking-prototype.html#faq-params",
            "name": "What water parameters does the Stocking Advisor monitor?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "The tool surfaces temperature, pH, hardness, and flow ranges for the selected community while flagging conflicts so aquarists can align their tank conditions before purchasing livestock."
            }
          },
          {
            "@type": "Question",
            "@id": "https://thetankguide.com/prototype/stocking-prototype.html#faq-updates",
            "name": "How often is the species library updated?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "We continuously build on our own research and real-world testing, blending it with trusted hobbyist knowledge and feedback from The Tank Guide community. Each update reflects new discoveries or refined care methods so the guidance stays accurate and easy to apply."
            }
          }
        ]
      }
    ]
  }
  </script>
  <script defer src="/js/nav.js?v=1.1.0"></script>
  <script defer src="/prototype/assets/js/filtration.js?v=proto_rm_2025_10_25"></script>
  <!-- proto guard: ensure legacy filtration card stays removed -->
  <script src="/prototype/assets/js/proto-guards.js?v=proto_rm_2025_10_25" defer></script>
  <style>
      :root {
        --fg: #eef3ff;
        --muted: rgba(235, 239, 251, 0.86);
        --panel: rgba(255, 255, 255, 0.08);
        --border: rgba(255, 255, 255, 0.14);
        --chip: rgba(255, 255, 255, 0.12);
        --ok: #12c278;
        --warn: #f4b400;
        --bad: #ff645c;
        --bar-bg: rgba(255, 255, 255, 0.12);
        --ghost: rgba(255, 255, 255, 0.25);
        --shadow: rgba(18, 30, 56, 0.18);
        --popover-bg: rgba(6, 12, 24, 0.96);
      }

    html,
    body {
      margin: 0;
      padding: 0;
      color: var(--fg);
      background: radial-gradient(circle at 12% 18%, rgba(66, 110, 255, 0.35), transparent 40%),
        radial-gradient(circle at 78% 12%, rgba(20, 215, 170, 0.28), transparent 45%),
        linear-gradient(180deg, rgba(10, 16, 32, 0.94), rgba(4, 8, 18, 0.98));
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      min-height: 100vh;
    }

    a {
      color: #a3c8ff;
    }

    .wrap {
      max-width: 1160px;
      margin: 0 auto;
      padding: 0 18px;
    }

      .stocking-page {
        position: relative;
        isolation: isolate;
      }

    .page-content {
      padding-bottom: 96px;
    }

    .hero {
      padding: 12px 0 32px;
      text-align: left;
    }

    .hero-title {
      margin: 0 0 4px;
    }

    .hero-subline {
      margin: 0 0 6px;
    }

    .brand-name {
      font-weight: 800;
      font-size: clamp(2.4rem, 3vw, 2.9rem);
      letter-spacing: -0.01em;
    }

    .brand-sub {
      font-size: 0.95rem;
      opacity: 0.85;
    }

      .tagline {
        font-size: 1.05rem;
        opacity: 0.85;
      }

    .hero .lead {
      max-width: 36rem;
      margin: 6px 0 10px;
      color: var(--muted);
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .page-content > .panel:first-of-type {
      margin-top: 10px;
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 20px 20px 22px;
      box-shadow: 0 18px 36px -24px var(--shadow);
      margin-bottom: 20px;
      backdrop-filter: blur(8px);
    }

    .controls-row .control-field {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
    }

    .control-field label {
      font-size: 0.92rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
    }

    .field-label-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-catalog-debug {
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      letter-spacing: 0.01em;
      color: var(--muted);
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 6px 12px;
      box-shadow: 0 8px 18px -14px var(--shadow);
    }

    .filter-catalog-debug[data-source='CATALOG'] {
      color: #b7f5d0;
    }

    .filter-catalog-debug[data-source='FALLBACK'] {
      color: #ffd9b5;
    }

    .field-label-row .info-btn,
    .filter-turnover-label .info-btn {
      --info-btn-visible: 30px;
      --info-btn-hit: 44px;
      font-size: 0.95rem;
      transform: none;
    }

    .filter-turnover {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: baseline;
    }

    .filter-turnover-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }

    .filter-turnover-value {
      font-variant-numeric: tabular-nums;
    }

    .link-like:focus-visible,
    button:focus-visible:not(.info-btn),
    .toggle:focus-visible {
      outline: 2px solid rgba(163, 200, 255, 0.7);
      outline-offset: 3px;
    }

    .link-like {
      background: none;
      border: 0;
      padding: 0;
      margin-left: 0.5rem;
      text-decoration: underline;
      cursor: pointer;
      font: inherit;
      color: #a3c8ff;
    }

    .link-like:hover {
      text-decoration: underline;
    }

    /* prototype-only modal styles */
    .modal-backdrop.hidden {
      display: none;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(6, 14, 30, 0.55);
      backdrop-filter: blur(2px);
      z-index: 9999;
      display: grid;
      place-items: center;
    }

    .modal.card {
      width: min(92vw, 640px);
      max-height: 85vh;
      overflow: auto;
      background: var(--card, #0f2742);
      color: var(--text, #e7f0ff);
      border-radius: 16px;
      padding: 20px 22px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.35);
      position: relative;
    }

    .icon-btn.modal-close {
      position: absolute;
      top: 10px;
      right: 12px;
      font-size: 22px;
      background: transparent;
      border: 0;
      color: inherit;
      cursor: pointer;
    }

    .modal .spaced li {
      margin: 12px 0;
    }

    .link-underline {
      text-decoration: underline;
      font-weight: 600;
    }

    .muted.small {
      font-size: 0.95rem;
      opacity: 0.9;
      margin-top: 0.5rem;
    }

    [data-role="tank-spec"] {
      pointer-events: none;
      text-decoration: none;
    }

    .conditions-list {
      display: grid;
      gap: 10px;
      margin: 18px 0 0;
      padding: 0;
      list-style: none;
    }

    .condition-item {
      display: grid;
      grid-template-columns: minmax(180px, 1fr) auto;
      gap: 10px;
      align-items: center;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.07);
    }

    .condition-item .label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }

    .condition-item .value {
      color: var(--muted);
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .condition-item[data-state="ok"] {
      border-color: rgba(54, 211, 153, 0.55);
    }

    .condition-item[data-state="warn"] {
      border-color: rgba(244, 180, 0, 0.6);
    }

    .condition-item[data-state="bad"] {
      border-color: rgba(255, 100, 92, 0.7);
    }

    .condition-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      font-weight: 700;
      font-size: 0.85rem;
    }

    .condition-item[data-state="ok"] .condition-icon {
      background: rgba(54, 211, 153, 0.25);
      color: #3ddc84;
    }

    .condition-item[data-state="warn"] .condition-icon {
      background: rgba(244, 180, 0, 0.22);
      color: #f4b400;
    }

    .condition-item[data-state="bad"] .condition-icon {
      background: rgba(255, 100, 92, 0.26);
      color: #ff645c;
    }

    .bars {
      display: grid;
      gap: 18px;
    }

    .bar-card {
      display: grid;
      gap: 10px;
    }

    .bar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .bar-header h3 {
      margin: 0;
      font-size: 1.1rem;
    }

    .bar-wrapper {
      position: relative;
      height: 22px;
      border-radius: 999px;
      background: var(--bar-bg);
      overflow: hidden;
    }

    .bar-fill,
    .bar-ghost {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      border-radius: 999px;
      transition: width 140ms ease;
    }

    .bar-fill {
      background: var(--ok);
    }

    .bar-ghost {
      background: var(--ghost);
      pointer-events: none;
    }

    .bar-text {
      font-size: 0.96rem;
      color: var(--muted);
    }

    .status-strip {
      border-radius: 12px;
      padding: 12px 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.02rem;
      color: #0b1228;
      background: rgba(255, 255, 255, 0.88);
    }

    .status-strip[data-state="ok"] {
      background: rgba(61, 220, 132, 0.92);
    }

    .status-strip[data-state="warn"] {
      background: rgba(244, 180, 0, 0.92);
    }

    .status-strip[data-state="bad"] {
      background: rgba(255, 100, 92, 0.92);
    }

    .chips {
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .chip {
      background: var(--chip);
      border: 1px solid rgba(255, 255, 255, 0.16);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 0.92rem;
      color: var(--fg);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip.warning,
    .chip[data-tone="warn"] {
      border-color: rgba(244, 180, 0, 0.6);
      color: #f4d48a;
    }

    .chip.danger,
    .chip[data-tone="bad"] {
      border-color: rgba(255, 100, 92, 0.7);
      color: #ffb3b0;
    }

    .chip__icon {
      font-size: 0.95em;
      line-height: 1;
    }

    .chip__text {
      display: inline;
    }

    .stock-grid {
      display: grid;
      gap: 16px;
    }

    .stock-row {
      display: grid;
      gap: 10px;
      grid-template-columns: 1fr;
    }

    .stock-row .see-gear {
      width: 100%;
      justify-content: center;
      margin-top: 0;
    }

    @media (min-width: 540px) {
      .stock-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
        align-items: end;
      }

      .stock-row .see-gear {
        grid-column: 1 / -1;
      }
    }

    @media (min-width: 780px) {
      .stock-row {
        grid-template-columns: minmax(160px, 1.4fr) repeat(2, minmax(120px, 1fr)) auto;
      }

      .stock-row .see-gear {
        grid-column: auto;
        width: auto;
        justify-self: end;
      }
    }

    .stock-list {
      display: grid;
      gap: 12px;
    }

    .stock-entry {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 8px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(255, 255, 255, 0.08);
    }

    .stock-entry__name {
      font-weight: 600;
      font-size: 1rem;
    }

    .stock-entry__meta {
      color: var(--muted);
      font-size: 0.95rem;
    }

    .stock-entry__remove {
      appearance: none;
      border: 0;
      border-radius: 10px;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.12);
      color: inherit;
      font-weight: 600;
      cursor: pointer;
      justify-self: start;
    }

    .stock-entry__remove:hover {
      background: rgba(255, 255, 255, 0.18);
    }

    @media (min-width: 640px) {
      .stock-entry {
        grid-template-columns: minmax(0, 1fr) auto auto;
        align-items: center;
      }

      .stock-entry__meta {
        justify-self: end;
      }

      .stock-entry__remove {
        justify-self: end;
      }
    }

    .stock-empty {
      padding: 10px 2px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .secondary-text {
      color: var(--muted);
      font-size: 0.92rem;
    }

    .subtle {
      color: var(--muted);
      font-size: 0.95rem;
    }

    .see-gear {
      margin-top: 24px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(90deg, rgba(77, 140, 255, 0.9), rgba(77, 200, 255, 0.88));
      color: #0b1228;
      border: none;
      border-radius: 12px;
      padding: 12px 18px;
      font-size: 1.02rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 16px 28px -20px rgba(52, 120, 255, 0.8);
      text-decoration: none;
    }

    .diagnostics {
      margin-top: 18px;
      background: rgba(10, 16, 32, 0.82);
      border: 1px dashed rgba(163, 200, 255, 0.4);
      border-radius: 14px;
      padding: 16px;
      display: grid;
      gap: 10px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .diagnostics h3 {
      margin: 0 0 4px;
      font-size: 1.05rem;
      color: var(--fg);
    }

    .diagnostics ul {
      margin: 0;
      padding-left: 20px;
      display: grid;
      gap: 4px;
    }

    .water-grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    /* --- Compact vertical rhythm for Stocking Advisor --- */
    #stocking-page {
      --space-xxs: 4px;
      --space-xs: 6px;
      --space-sm: 10px;
      --space-md: 14px;
      --space-lg: 18px;
    }

    #stocking-page .card,
    #stocking-page .panel {
      padding: var(--space-md) var(--space-md) calc(var(--space-md) + 2px);
      margin-bottom: var(--space-lg);
    }

    #stocking-page .ttg-card {
      padding: 12px 14px 14px;
    }

    @media (max-width: 480px) {
      #stocking-page .ttg-card {
        padding: 10px 12px 12px;
      }
    }

    #stocking-page .card + .card,
    #stocking-page .panel + .card,
    #stocking-page .card + .panel,
    #stocking-page .panel + .panel {
      margin-top: 0;
    }

    #stocking-page .card-title,
    #stocking-page .panel > h2 {
      margin: 0;
      line-height: 1.15;
    }

    #stocking-page .panel > h2 {
      margin-bottom: var(--space-sm);
    }

    #stocking-page .toggle-title {
      margin: 0;
    }

    #stocking-page .row {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #stocking-page .row.title-row {
      margin: 4px 0 4px;
    }

    #stocking-page .row.title-row.between {
      justify-content: space-between;
    }

    #stocking-page .env-header {
      position: relative;
      overflow: visible;
    }

    #stocking-page #env-card {
      overflow: visible;
      position: relative;
    }

    #stocking-page #env-card.is-tooltip-open {
      z-index: 30;
    }

    #stocking-page .env-header .title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      position: relative;
    }

    @media (orientation: portrait) and (max-width: 480px) {
      #stocking-page .env-header {
        position: relative;
      }

      #stocking-page .env-header .title-row {
        display: grid;
        grid-template-columns: 1fr auto;
        grid-template-rows: auto;
        align-items: center;
        column-gap: 10px;
        justify-content: initial;
      }

      #stocking-page .env-header .title-row .card-title {
        grid-column: 1 / 2;
        margin: 0;
        line-height: 1.15;
      }

      #stocking-page #env-info-btn {
        grid-column: 2 / 3;
        align-self: start;
        margin-top: 2px;
      }

      #stocking-page .env-header .card-subtitle {
        margin-top: 4px;
        grid-column: 1 / -1;
      }
    }

    #stocking-page .card-header {
      margin-bottom: 8px;
    }

    #stocking-page .card-header .card-subtitle {
      margin: 2px 0 0;
      font-size: 13px;
      line-height: 1.35;
      color: rgba(255, 255, 255, 0.72);
    }

    #stocking-page .card p,
    #stocking-page .panel p {
      margin-top: var(--space-xs);
      margin-bottom: var(--space-sm);
    }

    #stocking-page .tank-size-card .form-row {
      margin-bottom: var(--space-xs);
    }

    #stocking-page .select-wrap {
      margin: 8px 0 10px;
    }

    #stocking-page .select-wrap select {
      min-height: 44px;
      padding-right: 44px;
    }

    #stocking-page .tank-size-card .facts-line {
      margin-top: var(--space-sm);
      margin-bottom: var(--space-sm);
    }

    #stocking-page #stock-list {
      gap: var(--space-sm);
    }

    #stocking-page #stock-list .stock-entry {
      padding: var(--space-sm) var(--space-md);
      gap: var(--space-xs);
    }

    #stocking-page #stock-list .stock-entry__meta {
      margin-top: var(--space-xxs);
    }

    #stocking-page #stock-list .stock-entry__remove {
      min-height: 44px;
    }

    #stocking-page #stock-list .stock-entry + .stock-entry {
      margin-top: 0;
    }

    #stocking-page #stock-list-card .stock-empty {
      padding: var(--space-sm) var(--space-xs);
    }

    #stocking-page .env-card .section-lead {
      margin-bottom: var(--space-sm);
    }

    #stocking-page .env-card .env-divider {
      margin: var(--space-sm) 0;
    }

    #stocking-page .env-card table {
      border-spacing: 0;
    }

    #stocking-page .env-card table th,
    #stocking-page .env-card table td {
      padding: 10px 12px;
      line-height: 1.25;
    }

    #stocking-page .env-bars {
      margin-top: 10px;
      row-gap: 10px;
    }

    #stocking-page .env-bars .env-bar,
    #stocking-page .env-bars .bar-row {
      margin-bottom: var(--space-xs);
      padding-top: var(--space-xs);
      padding-bottom: var(--space-xs);
    }

    #stocking-page .env-bars .env-bar:last-child,
    #stocking-page .env-bars .bar-row:last-child {
      margin-bottom: 0;
    }

    /* ----- Compact Bioload/Aggression card adjustments ----- */
    #stocking-page #bioagg-card {
      min-height: 0 !important;
      height: auto !important;
      flex: 0 0 auto !important;
    }

    #stocking-page #bioagg-card.is-compact {
      padding-top: 8px;
      padding-bottom: 10px;
    }

    @media (orientation: portrait) and (max-width: 480px) {
      #stocking-page #bioagg-card.is-compact {
        padding-top: 6px;
        padding-bottom: 8px;
      }
    }

    #stocking-page button:not(.info-btn),
    #stocking-page select {
      min-height: 44px;
    }

    @media (max-width: 480px) {
      #stocking-page {
        --space-sm: 8px;
        --space-md: 12px;
        --space-lg: 16px;
      }

      #stocking-page .ttg-card {
        padding: 10px 12px 12px;
      }

      #stocking-page .row {
        gap: 8px;
      }

      #stocking-page .row.title-row {
        margin: 2px 0 2px;
      }

      #stocking-page .card-header {
        margin-bottom: 6px;
      }

      #stocking-page .card-header .card-subtitle {
        font-size: 12.5px;
      }

      #stocking-page .env-card table th,
      #stocking-page .env-card table td {
        padding: 8px 10px;
      }
    }

    @media (min-width: 1024px) {
      .hero {
        padding-top: 16px;
      }

      .page-content > .panel:first-of-type {
        margin-top: 14px;
      }
    }

    #stocking-page .tank-size-card + .card-spacer:empty {
      display: none !important;
    }

    .hero-how-works {
      margin-right: 0.5rem;
    }
  </style>
  <!-- Consent Mode defaults (load FIRST) -->
  <script src="/assets/js/consent-mode.js" defer></script>
  <!-- Google tag (gtag.js) — GA4 -->
  <!--#include virtual="/includes/ga4.html" -->

  <!-- --- Google CMP (Funding Choices) START --- -->
  <script async src="https://fundingchoicesmessages.google.com/i/pub-9905718149811880?ers=1"></script>
  <script>
    // Required bootstrap per Google; signals CMP presence
    (function() {
      function signalGooglefcPresent() {
        if (!window.frames['googlefcPresent']) {
          if (document.body) {
            const iframe = document.createElement('iframe');
            iframe.style.cssText = 'display:none';
            iframe.name = 'googlefcPresent';
            document.body.appendChild(iframe);
          } else {
            setTimeout(signalGooglefcPresent, 0);
          }
        }
      }
      signalGooglefcPresent();
    })();
  </script>
  <!-- --- Google CMP (Funding Choices) END --- -->
</head>
<body class="theme-dark prototype-stock-page">
  <div id="site-nav"></div>
  <main id="stocking-page" class="stocking-page proto-stock">
    <header class="hero">
      <div class="wrap">
        <div class="hero-header">
          <h1 class="brand-name hero-title" id="page-title">Stocking Advisor</h1>
          <p class="hero-subline">Prepared by The Tank Guide (A FishKeepingLifeCo Project).</p>
          <p class="tagline hero-tagline lead">Plan a healthy community by checking bioload, compatibility — and get recommended water parameters for your tank.</p>
          <!-- Inline "How it works" link (prototype only) -->
          <div class="muted small info-inline" id="how-it-works-inline-wrap">
            <a href="#" id="hero-how-works" class="hero-how-works link-underline">How it works</a>
            <div class="info-trigger" data-info-scope="stocking-tip">
              <button
                id="stocking-tip-btn"
                type="button"
                class="proto-info-trigger info-btn"
                aria-haspopup="dialog"
                aria-controls="pop-stocking-tip"
                aria-expanded="false"
                aria-label="Stocking tip details"
                data-proto-popover="pop-stocking-tip"
              >i</button>
              <div id="pop-stocking-tip" class="proto-popover" role="dialog" aria-labelledby="pop-stocking-tip-title" tabindex="-1" hidden>
                <header>
                  <h3 id="pop-stocking-tip-title">Stocking Tip</h3>
                  <button type="button" data-close aria-label="Close">×</button>
                </header>
                <div role="document" aria-labelledby="pop-stocking-tip-title">
                  <p>
                    Always quarantine new livestock. During stocking phases, test ammonia,
                    nitrite, and nitrate weekly, and log temperature, pH, and hardness.
                    Consistent tracking helps your parameters stay stable as the biofilter adapts.
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div id="stocking-status" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
        </div>
      </div>
    </header>

    

    <div class="wrap page-content">
      <div class="ad-container ad-hero" role="complementary" aria-label="Advertisement">
        <span class="ad-label">Advertisement</span>
      </div>
      
      <!-- Tank Size card -->
      <div class="card ttg-card tank-size-card" id="tank-size-card">
        <div class="card-header">
          <div class="row title-row between">
            <div class="sa-proto-tank-size-label">
              <h2 class="card-title" id="tank-size-heading">Tank Size</h2>
              <div class="info-trigger" data-info-scope="tank-size">
                <button
                  type="button"
                  class="proto-info-trigger info-btn"
                  aria-haspopup="dialog"
                  aria-controls="pop-tank-size"
                  aria-expanded="false"
                  aria-label="How tank size selections work"
                  data-proto-popover="pop-tank-size"
                >i</button>
                <div id="pop-tank-size" class="proto-popover" role="dialog" aria-labelledby="pop-tank-size-title" tabindex="-1" hidden>
                  <header>
                    <h3 id="pop-tank-size-title">Tank size picker</h3>
                    <button type="button" data-close aria-label="Close">×</button>
                  </header>
                  <div role="document" aria-labelledby="pop-tank-size-title">
                    <ul>
                      <li>Select your aquarium volume to anchor stocking, parameter, and filter calculations.</li>
                      <li>Preset options reflect popular tank footprints, but you can type a custom gallon value anytime.</li>
                      <li>Adjustments update every card instantly so you can compare scenarios before buying equipment.</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <p class="card-subtitle">Select a tank size to begin.</p>
        </div>

        <div class="form-row">
          <label for="tank-size" class="sr-only">Tank size</label>
          <div class="select-wrap" id="tank-size-select-wrap">
            <select id="tank-size" name="tank-size" data-role="tank-size" aria-label="Tank size" data-testid="tank-gallons"></select>
            <svg class="chevron" aria-hidden="true" focusable="false" viewBox="0 0 24 24">
              <path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>

          <!-- Facts line stays; starts EMPTY to avoid duplicate helper text -->
          <div class="facts-line muted-text" data-role="tank-spec" aria-live="polite"></div>

          <div class="filter-flow-control" data-role="filter-setup">
            <div class="filter-product-field">
              <div class="field-label-row">
                <label for="filter-product">Filter Product</label>
                <div class="info-trigger" data-info-scope="filter-product">
                  <button
                    type="button"
                    class="proto-info-trigger info-btn"
                    aria-haspopup="dialog"
                    aria-controls="pop-filter-product"
                    aria-expanded="false"
                    aria-label="More info about selecting a filter product"
                    data-proto-popover="pop-filter-product"
                  >i</button>
                  <div id="pop-filter-product" class="proto-popover" role="dialog" aria-labelledby="pop-filter-product-title" tabindex="-1" hidden>
                    <header>
                      <h3 id="pop-filter-product-title">Picking a filter</h3>
                      <button type="button" data-close aria-label="Close">×</button>
                    </header>
                    <div role="document" aria-labelledby="pop-filter-product-title">
                      <ul>
                        <li>Select a model rated for your tank volume or one size larger for heavy stocking plans.</li>
                        <li>Choosing a product fills in its rated gallons-per-hour so turnover math stays accurate.</li>
                        <li>Switch to a custom entry if you run multiple filters or throttle the manufacturer flow.</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="filter-catalog-debug"
                id="filter-catalog-debug"
                role="status"
                aria-live="polite"
                data-source="FALLBACK"
              >Catalog source: FALLBACK • Loaded: 0 | Size-matched: 0</div>
              <div class="proto-inline-controls" data-role="filter-product-controls">
                <div class="select-wrap proto-inline-controls__field">
                  <select id="filter-product" name="filter-product" aria-describedby="filter-product-note">
                    <option value="">— Select a product —</option>
                  </select>
                  <svg class="chevron" aria-hidden="true" focusable="false" viewBox="0 0 24 24">
                    <path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </div>
                <button
                  type="button"
                  id="filter-product-add"
                  class="proto-add-button proto-add-button--primary"
                  disabled
                  aria-disabled="true"
                >Add Selected</button>
              </div>
              <p class="filter-product-note" id="filter-product-note">Choose a filter matched to your tank size and use Add Selected when ready.</p>
            </div>
            <div class="filter-setup">
              <p class="muted">Choose a filter to estimate how much water flow your tank has per hour.</p>

              <div class="filter-setup__row" role="group" aria-label="Add custom filter">
                <label class="visually-hidden" for="fs-type">Filter type</label>
                <select id="fs-type" class="fs-input fs-select">
                  <option value="" selected disabled>Filter type…</option>
                  <option>HOB</option>
                  <option>Canister</option>
                  <option>Internal</option>
                  <option>Sponge</option>
                  <option>Powerhead</option>
                </select>

                <label class="visually-hidden" for="fs-gph">Rated flow (GPH)</label>
                <input id="fs-gph" class="fs-input fs-gph" inputmode="numeric" pattern="[0-9]*" placeholder="GPH">

                <button id="fs-add-custom" type="button" class="btn btn-primary btn-compact" aria-disabled="true">
                  Add custom
                </button>
              </div>

              <p class="hint">Tip: press Enter in the GPH field to add quickly.</p>
            </div>
            <div class="filter-flow-meta">
              <div
                class="proto-filter-chips fp-chip-list"
                data-role="proto-filter-chips"
                role="list"
                aria-live="polite"
              ></div>
              <p class="proto-filter-empty" data-role="proto-filter-empty">No filters added yet.</p>
              <div class="filter-turnover turnover-block" id="filter-turnover" aria-live="polite">
                <div class="field-label-row">
                  <label class="field-label" for="turnoverValue">Estimated turnover</label>
                  <div class="info-trigger" data-info-scope="turnover">
                    <button
                      type="button"
                      class="proto-info-trigger info-btn field-label-info"
                      aria-haspopup="dialog"
                      aria-controls="pop-turnover"
                      aria-expanded="false"
                      aria-label="More info about turnover"
                      data-proto-popover="pop-turnover"
                    >i</button>
                    <div id="pop-turnover" class="proto-popover" role="dialog" aria-labelledby="pop-turnover-title" tabindex="-1" hidden>
                      <header>
                        <h3 id="pop-turnover-title">Turnover targets</h3>
                        <button type="button" data-close aria-label="Close">×</button>
                      </header>
                      <div role="document" aria-labelledby="pop-turnover-title">
                        <ul>
                          <li>Turnover compares your filter flow to the aquarium volume (GPH ÷ gallons).</li>
                          <li>General community tanks thrive around 5–7× per hour; active species often prefer 8× or more.</li>
                          <li>If the number dips low, consider upsizing filtration or adding supplemental circulation.</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                <p class="proto-filter-summary" data-role="proto-filter-summary">Filtration: 0 GPH • 0.0×/h</p>
                <div class="heads-up-note" role="note">
                  <p><strong>Heads-up for later:</strong> As your tank matures—especially if you add lots of healthy, fast-growing plants—your effective capacity can change. Keep testing your water and revisit your plan after cycling.</p>
                </div>
                <span class="filter-turnover-value" data-role="filter-turnover-value" aria-hidden="true" hidden>—</span>
                <!-- Mirrors .filter-flow-input__field > input styling from Rated flow (GPH) field -->
                <!-- PROTOTYPE-ONLY: Compact turnover field -->
                <div class="proto-input-group proto-turnover">
                  <input
                    id="turnoverValue"
                    class="proto-input proto-input--compact"
                    type="text"
                    inputmode="decimal"
                    aria-label="Estimated turnover in tank volumes per hour"
                    value="5.0"
                    placeholder="—"
                    readonly
                  />
                  <span class="proto-input-suffix" aria-hidden="true">×/h</span>
                </div>
              </div>
              <p class="filter-product-meta" id="filter-product-label" hidden></p>
            </div>
          </div>
      </div>

      <style>
        /* Layout tightening */
        .tank-size-card .form-row {
          margin-bottom: 8px;
        }

        /* --- Tank Size chevron styles (scoped) --- */
        .tank-size-card .select-wrap {
          position: relative;
        }
        .tank-size-card .select-wrap select {
          display: block;
          width: 100%;
          height: 44px;
          line-height: 44px;
          padding: 0 44px 0 14px;
          border-radius: 12px;
          border: 1px solid rgba(255, 255, 255, 0.12);
          background: rgba(255, 255, 255, 0.06);
          color: inherit;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          /* iOS: keeps native picker while allowing custom icon */
        }
        .tank-size-card .select-wrap .chevron {
          position: absolute;
          right: 14px;
          top: 50%;
          width: 16px;
          height: 16px;
          transform: translateY(-50%);
          opacity: 0.8;
          pointer-events: none;
          /* IMPORTANT: never block taps on the select */
          transition: transform 0.18s ease, opacity 0.18s ease;
        }
        .tank-size-card .select-wrap:hover .chevron {
          opacity: 0.95;
        }
        .tank-size-card .select-wrap.open .chevron {
          transform: translateY(-50%) rotate(180deg);
        }
        .tank-size-card .select-wrap select:focus {
          outline: 2px solid rgba(20, 203, 168, 0.55);
          outline-offset: 2px;
        }
        @media (prefers-reduced-motion: reduce) {
          .tank-size-card .select-wrap .chevron {
            transition: none;
          }
        }

          /* Facts line (empty when none selected) */
          .tank-size-card .facts-line {
            margin-top: 8px;
          }

          .heads-up-note {
            margin-top: 12px;
            padding: 12px 14px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.16);
            font-size: 0.95rem;
            line-height: 1.5;
            color: var(--muted);
          }

          .heads-up-note strong {
            color: var(--fg);
          }

        /* Ensure the card can host positioned children safely */
        .tank-size-card { position: relative; }

        /* Info buttons adopt Cycling Coach parity */
        #stocking-page .info-btn {
          --info-btn-hit: 44px;
          --info-btn-visible: 30px;
          --info-btn-bg: rgba(255, 255, 255, 0.12);
          --info-btn-bg-hover: rgba(255, 255, 255, 0.18);
          --info-btn-bg-active: rgba(255, 255, 255, 0.14);
          --info-btn-border: rgba(255, 255, 255, 0.24);
          --info-btn-border-hover: rgba(255, 255, 255, 0.32);
          --info-btn-border-active: rgba(255, 255, 255, 0.28);
          --info-btn-focus: rgba(20, 203, 168, 0.7);
          --info-btn-icon: var(--fg);
          font-size: 0.95rem;
          transform: none;
        }

        /* Env. Recommendations single icon “expanded” state (if present) */
        #stocking-page [data-role="env-info"][aria-expanded="true"] {
          --info-btn-bg: rgba(20, 203, 168, 0.9);
          --info-btn-bg-hover: rgba(20, 203, 168, 0.95);
          --info-btn-bg-active: rgba(20, 203, 168, 0.82);
          --info-btn-border: rgba(20, 203, 168, 0.95);
          --info-btn-border-hover: rgba(20, 203, 168, 1);
          --info-btn-border-active: rgba(20, 203, 168, 0.92);
          --info-btn-focus: rgba(20, 203, 168, 0.55);
          color: #0b1b18;
        }

        #stocking-page [data-role="env-info"][aria-expanded="true"]::before {
          box-shadow: 0 0 0 2px rgba(20, 203, 168, 0.25);
        }

        /* Environmental legend collapsed by default */
        #stocking-page #env-card [data-role="env-legend"] {
          display: none;
          margin: 0;
          padding-top: 0;
          opacity: 0;
          transition: opacity 160ms ease;
        }

        #stocking-page #env-card.info-open [data-role="env-legend"] {
          display: block;
          opacity: 1;
        }

        #stocking-page #env-card .env-bars .env-bar,
        #stocking-page #env-card .env-bars .bar-row {
          margin-bottom: 0;
        }

        #stocking-page #env-card.info-open .env-bars .env-bar,
        #stocking-page #env-card.info-open .env-bars .bar-row {
          margin-bottom: var(--space-xs);
        }

        #stocking-page #env-card.info-open .env-bars .env-bar:last-child,
        #stocking-page #env-card.info-open .env-bars .bar-row:last-child {
          margin-bottom: 0;
        }

      </style>

      <section class="card ttg-card" id="stock-list-card" aria-live="polite">
        <div class="card-header">
          <div class="row title-row between">
            <div class="card-title-row">
              <h2 class="card-title">Current Stock</h2>
              <div class="info-trigger" data-info-scope="stocking-checklist">
                <button
                  type="button"
                  id="stocking-checklist-btn"
                  class="proto-info-trigger info-btn"
                  aria-haspopup="dialog"
                  aria-controls="pop-stocking-checklist"
                  aria-expanded="false"
                  aria-label="View Responsible Stocking Checklist"
                  data-proto-popover="pop-stocking-checklist"
                >i</button>
                <div id="pop-stocking-checklist" class="proto-popover" role="dialog" aria-labelledby="pop-stocking-checklist-title" tabindex="-1" hidden>
                  <header>
                    <h3 id="pop-stocking-checklist-title">Responsible Stocking Checklist</h3>
                    <button type="button" data-close aria-label="Close">×</button>
                  </header>
                  <div role="document" aria-labelledby="pop-stocking-checklist-title">
                    <ul>
                      <li>Verify your nitrogen cycle is stable with zero ammonia and nitrite before introducing new species.</li>
                      <li>Match species by temperature, pH, and hardness tolerances, leaning into the overlapping sweet spot.</li>
                      <li>Stage livestock additions over several weeks so the biofilter can adjust without stress spikes.</li>
                      <li>Seed extra bio media to buffer bioload swings as you expand the community.</li>
                      <li>Keep a quick log of maintenance, feedings, and behavior shifts so you can course-correct early.</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <p class="card-subtitle">Your selected fish and inverts appear here. No stock yet. Add species to begin.</p>
        </div>
        <div id="stock-list" class="stock-list" data-testid="species-list"></div>
      </section>

      <section class="card ttg-card tank-env-card env-card" id="env-card" data-role="env-card" aria-live="polite">
        <div class="card-header env-header">
          <div class="row title-row">
            <h2 class="card-title">Environmental Recommendations</h2>
            <div class="info-trigger" data-info-scope="env-info">
              <button
                type="button"
                class="proto-info-trigger info-btn"
                aria-haspopup="dialog"
                id="env-info-btn"
                data-role="env-info"
                aria-controls="pop-env-info"
                aria-expanded="false"
                aria-label="More info and tips about Environmental Recommendations"
                data-proto-popover="pop-env-info"
              >i</button>
              <div id="pop-env-info" class="proto-popover" role="dialog" aria-labelledby="pop-env-info-title" tabindex="-1" hidden>
                <header>
                  <h3 id="pop-env-info-title">Environmental Card Guide</h3>
                  <button type="button" data-close aria-label="Close">×</button>
                </header>
                <div role="document" aria-labelledby="pop-env-info-title">
                  <ul>
                    <li>Ranges blend the overlapping temperature, pH, hardness, and flow preferences of the fish you add.</li>
                    <li>Alerts surface when your planned community drifts outside that shared band so you can adjust stock or gear.</li>
                    <li>Use these guardrails as a starting point and verify with your own water tests before introducing livestock.</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <p class="card-subtitle">Derived from your selected stock.</p>
          <div class="env-compact-summary" data-role="env-compact-summary" aria-hidden="true" hidden>
            <span data-field="summary-text">Add species to see recommendations.</span>
          </div>
        </div>

        <div class="card-body" data-role="env-body">
          <div id="env-warnings" class="env-warnings" hidden></div>
          <div id="env-reco" class="env-list" role="list" data-role="env-table"></div>
          <div id="env-reco-xl" class="env-grid-xl env-table" hidden data-role="env-table"></div>

          <hr class="env-divider" aria-hidden="true" />

          <div id="env-bars" class="env-bars" data-testid="stock-bars">
            <!-- populated by JS: Bioload Capacity + Compatibility chips -->
          </div>

          <div id="env-more-tips" class="env-more-tips env-tips" data-role="env-legend" hidden>
            <!-- brief bullets about GH/KH, salinity, blackwater, and flow zones -->
          </div>
        </div>
      </section>

      <section class="panel" aria-labelledby="stock-title">
        <h2 id="stock-title">Plan Your Stock</h2>
        <div class="stock-grid">
          <div
            class="stock-row"
            role="group"
            aria-labelledby="candidate-label"
          >
            <div class="control-field">
              <label id="candidate-label" for="plan-species">Species</label>
              <select id="plan-species" class="control" data-testid="species-search"></select>
            </div>
            <div class="control-field">
              <label for="plan-qty">Quantity</label>
              <input
                class="control"
                id="plan-qty"
                name="quantity"
                type="text"
                inputmode="numeric"
                pattern="[0-9]*"
                placeholder="Qty"
                autocomplete="off"
                enterkeyhint="done"
              />
            </div>
            <button id="plan-add" class="see-gear" type="button" data-testid="btn-add-species">Add to Stock</button>
          </div>
          <div class="chips" id="candidate-chips"></div>
          <div
            id="candidate-banner"
            class="status-strip"
            data-state="bad"
            style="display:none;"
            data-testid="status-banner"
          >
            Stocking safeguards: fix highlighted issues before adding.
          </div>
        </div>
      </section>


      <a class="see-gear" id="btn-gear" href="/gear.html" data-testid="btn-gear">See Gear Suggestions</a>

      <!-- === TTG_StockingBottom (post-results, before footer) === -->
      <div class="ad-slot-placeholder" role="complementary" aria-label="Advertisement">
        <strong>Advertisement</strong>
        <p>This post-results placement reserves space for contextual ads that complement aquarium planning advice. Educational copy continues below so the experience stays helpful even when ads are paused.</p>
      </div>

      <section id="post-results-explainer" class="ttg-explainer--bg">
        <h2>Plan Your Aquarium with Confidence</h2>
        <p>The Stocking Advisor helps you build a calm, healthy tank. It uses real-world stocking data and hobby feedback to show you—at a glance—how your choices affect bioload, filtration needs, and species mix. No spreadsheets. No guesswork.</p>

        <h2>The Science Behind the Recommendations</h2>

        <h3>Bioload, not “inches per gallon”</h3>
        <p>The Advisor estimates bioload—how much waste your stock produces—using conservative rules plus activity multipliers. Fast swimmers (like danios) add more load than slow cruisers (like gouramis). Because this walkthrough assumes a fresh setup, only your filtration setup reduces the effective load; revisit your plan after cycling if you grow a dense plant canopy.</p>

        <h3>Water chemistry guardrails</h3>
        <p>Each species carries preferred ranges for temperature, pH, and hardness. If your plan mixes fish outside a shared range, the Environmental card highlights it so you can adjust stock, remineralize, or tweak heat and flow.</p>

        <h3>Compatibility and behavior</h3>
        <p>The Advisor warns about known problem pairs—fin nippers with long fins, shrimp-unsafe hunters with inverts, or aggressive fish with peaceful schooling species—so you can fix issues before they’re in the water.</p>

        <p>
          When your plan looks good, head to the 
          <a href="https://thetankguide.com/gear/" target="_blank" rel="noopener noreferrer">Gear Guide</a> 
          to match filters, heaters, and lights, or brush up on testing in the 
          <a href="https://thetankguide.com/params.html" target="_blank" rel="noopener noreferrer">Cycling Coach</a>. 
          And if you’d like, you can even have your tank featured by us — 
          <a href="https://thetankguide.com/feature-your-tank.html" target="_blank" rel="noopener noreferrer">Submit your tank</a> 
          or 
          <a href="https://thetankguide.com/pages/community-video-picks.html" target="_blank" rel="noopener noreferrer">see featured tanks from the community</a>.
        </p>
      </section>

      <section class="advisor-faq" id="stocking-faq">
        <h2>Stocking Advisor FAQ</h2>
          <details>
            <summary>How accurate are the tank size recommendations?</summary>
            <p>The advisor uses a balanced approach that considers species behavior, activity level, and conservative new-tank assumptions. It avoids rigid “rules” and instead provides conservative starting points so aquarists can fine-tune their stocking levels through regular testing and observation.</p>
          </details>
          <details>
            <summary>Why don’t plants change capacity here?</summary>
            <p><strong>Q:</strong> Why don’t plants change capacity here?<br /><strong>A:</strong> This tool is a new-tank walkthrough. Fresh setups don’t have established plant mass or stable growth, so we don’t count a plant bonus. After your tank cycles and plants are thriving, your effective capacity may improve. That’s why we recommend <strong>regular water testing</strong> (ammonia, nitrite, nitrate, pH, KH/GH) and <strong>rechecking your plan</strong> as the tank matures.</p>
          </details>
        <details>
          <summary>What water parameters does the Stocking Advisor monitor?</summary>
          <p>Temperature, pH, carbonate hardness, general hardness, and flow are tracked for every species profile. When a planned community falls outside those overlapping bands, the tool surfaces alerts so you can adjust gear or livestock before completing the build.</p>
        </details>
        <details>
          <summary>How often is the species library updated?</summary>
          <p>We continuously build on our own research and real-world testing, blending it with trusted hobbyist knowledge and feedback from The Tank Guide community. Each update reflects new discoveries or refined care methods so the guidance stays accurate and easy to apply.</p>
        </details>
      </section>

    </div>

    <section class="seo-intro">
      <div class="wrap">
        <p>The Tank Guide Stocking Advisor calculates aquarium bioload and compatibility. Plan balanced communities of bettas, tetras, shrimp, and more, powered by FishKeepingLifeCo.</p>
      </div>
    </section>
  </main>

  <script type="importmap">
    {
      "imports": {
        "/js/logic/compute.js": "/prototype/js/logic/compute-proxy.js",
        "./logic/compute.js": "/prototype/js/logic/compute-proxy.js"
      }
    }
  </script>

    <script type="module" src="/js/logic/speciesSchema.js"></script>
  <script type="module" src="/js/fish-data.js"></script>
  <script type="module" src="/js/logic/compute.js"></script>
  <script type="module" src="/js/logic/conflicts.js"></script>
  <script type="module" src="/js/stocking.js?v=2024-09-01" id="js-stocking"></script>
  <script type="module" src="/js/tank-size-card.js?v=2024-09-01"></script>
  <script type="module" src="/prototype/assets/js/ui-meters.js" defer></script>
  <script type="module" src="/prototype/js/proto-filtration.js"></script>
  <script type="module" defer src="/prototype/assets/js/proto-filter-tests.js"></script>

  <!-- How it works modal (prototype only) -->
  <div id="how-modal" class="modal-backdrop hidden" aria-hidden="true">
    <div class="modal card" role="dialog" aria-modal="true" aria-labelledby="how-modal-title">
      <button type="button" class="icon-btn modal-close" id="how-close" aria-label="Close dialog">×</button>
      <h3 id="how-modal-title">How the Stocking Advisor works</h3>
        <ol class="spaced">
          <li><strong>Pick your tank size.</strong> Enter a volume or choose a preset — stocking levels update right away.</li>
          <li><strong>Select your filter.</strong> Choose a model to auto-fill flow; adjust GPH if you’ve modded your setup.</li>
          <li><strong>Add your fish.</strong> Search and add species. Reorder or remove as you plan. Chips flag conflicts.</li>
          <li><strong>Review the health cards.</strong> See target temperature, pH, hardness, and flow — and how to stay there.</li>
        </ol>
      <div class="actions">
        <button type="button" class="btn primary" id="how-ok">Close</button>
      </div>
    </div>
  </div>

  <script>
    (() => {
      const link = document.getElementById('hero-how-works') || document.getElementById('how-it-works-link');
      const modal = document.getElementById('how-modal');
      const closeX = document.getElementById('how-close');
      const okBtn = document.getElementById('how-ok');

      if (!link || !modal) return;

      const show = () => {
        modal.classList.remove('hidden');
        modal.setAttribute('aria-hidden', 'false');
        const initialFocus = closeX || okBtn;
        if (initialFocus && typeof initialFocus.focus === 'function') {
          initialFocus.focus();
        }
        document.body.style.overflow = 'hidden';
      };

      const hide = () => {
        modal.classList.add('hidden');
        modal.setAttribute('aria-hidden', 'true');
        if (link && typeof link.focus === 'function') {
          link.focus();
        }
        document.body.style.overflow = '';
      };

      link.addEventListener('click', (e) => {
        e.preventDefault();
        show();
      });
      closeX?.addEventListener('click', hide);
      okBtn?.addEventListener('click', hide);

      modal.addEventListener('click', (e) => {
        if (e.target === modal) hide();
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') hide();
      });
    })();
  </script>

<!-- === TTG Cookie Consent START === -->
<div id="ttg-consent" class="ttg-consent" data-consent-banner>
  <div class="ttg-consent__inner" role="dialog" aria-labelledby="ttg-consent-title" aria-describedby="ttg-consent-desc">
    <h3 id="ttg-consent-title">Cookies & Advertising</h3>
    <p id="ttg-consent-desc">
      We use cookies to run this site and (if you allow) to show relevant ads from Google AdSense. You can accept all cookies, reject personalized ads, or manage preferences anytime.
    </p>
    <div class="ttg-consent__actions">
      <button type="button" class="ttg-btn ttg-btn--secondary js-consent-reject" id="ttg-consent-reject">Reject (Non-personalized)</button>
      <button type="button" class="ttg-btn ttg-btn--ghost" id="ttg-consent-manage">Manage</button>
      <button type="button" class="ttg-btn ttg-btn--primary js-consent-accept" id="ttg-consent-accept">Accept All</button>
    </div>
  </div>
</div>

<div id="ttg-consent-modal" class="ttg-consent-modal" hidden aria-modal="true" role="dialog" aria-labelledby="ttg-consent-modal-title">
  <div class="ttg-consent-modal__panel">
    <h3 id="ttg-consent-modal-title">Cookie Preferences</h3>
    <form id="ttg-consent-form">
      <label class="ttg-row">
        <input type="checkbox" checked disabled />
        <span><strong>Essential</strong> — required for core site functions.</span>
      </label>
      <label class="ttg-row">
        <input type="checkbox" id="ttg-c-analytics" />
        <span><strong>Analytics</strong> — understand usage (if enabled later).</span>
      </label>
      <label class="ttg-row">
        <input type="checkbox" id="ttg-c-ads" />
        <span><strong>Advertising</strong> — allow personalized ads (Google AdSense).</span>
      </label>
      <div class="ttg-consent-modal__actions">
        <button type="button" class="ttg-btn ttg-btn--ghost" id="ttg-consent-cancel">Cancel</button>
        <button type="submit" class="ttg-btn ttg-btn--primary">Save Preferences</button>
      </div>
    </form>
  </div>
</div>

<!-- === TTG Consent Banner Controller START === -->
  <script defer src="/assets/js/consent-banner.js"></script>
<!-- === TTG Consent Banner Controller END === -->


<!-- === TTG CMP Consent Bridge START === -->
<script>
(function(){
  // Helper: map TCF consent to our single "ads granted" flag.
  // We consider "granted" only when Purpose 1 (storage) AND Purpose 4 (select personalised ads)
  // are consented. If you want to allow NON-personalised ads when only Purpose 1 is granted,
  // set allowNPA=true below.
  var allowNPA = true; // if true, we’ll treat Purpose 1 only as "granted" for showing slots (Google will serve NPA ads).

  function setAdConsent(granted){
    document.documentElement.setAttribute('data-ad-consent', granted ? 'granted' : 'denied');
    document.documentElement.classList.toggle('is-ads-disabled', !granted);
    window.__TTG_ADS_DISABLED__ = !granted;
    // Inform any listeners (our ad loader later)
    window.dispatchEvent(new CustomEvent('ttg:consent-change', {detail:{granted}}));
  }

  // If Google CMP is present, it defines __tcfapi.
  function hookTCF(){
    if (typeof window.__tcfapi !== 'function') return false;

    // Hide our local cookie banner when Google CMP is running (EEA users).
    try{
      var banner = document.getElementById('ttg-consent');
      var modal  = document.getElementById('ttg-consent-modal');
      if (banner){ banner.hidden = true; banner.classList.remove('is-open'); }
      if (modal)  modal.hidden  = true;
    }catch(e){}

    // Listen for consent changes
    window.__tcfapi('addEventListener', 2, function(tcData, ok){
      if(!ok || !tcData) return;
      // Purpose 1 = storage; Purpose 4 = personalised ads
      var p = (tcData.purpose && tcData.purpose.consents) || {};
      var hasP1 = !!p[1];
      var hasP4 = !!p[4];

      var granted = allowNPA ? hasP1 : (hasP1 && hasP4);
      setAdConsent(granted);
    });

    // Also fetch current state once
    window.__tcfapi('getTCData', 2, function(tcData, ok){
      if(!ok || !tcData) return;
      var p = (tcData.purpose && tcData.purpose.consents) || {};
      var hasP1 = !!p[1];
      var hasP4 = !!p[4];
      var granted = allowNPA ? hasP1 : (hasP1 && hasP4);
      setAdConsent(granted);
    });

    return true;
  }

  // Try to hook immediately; if CMP loads a bit later, poll briefly
  if (!hookTCF()){
    var tries = 0, t = setInterval(function(){
      tries++;
      if (hookTCF() || tries > 40) clearInterval(t); // up to ~4s
    }, 100);
  }

  // Fallback for non-EEA visitors (no __tcfapi): keep using our local preference
  // Our existing local banner writes ttgConsentV2 with {ads:true|false}.
  // If CMP absent, keep existing behavior (do not force-show anything here).

})();
</script>
<!-- === TTG CMP Consent Bridge END === -->

<!-- === TTG Cookie Consent END === -->

<!-- === TTG Ad Slot View Tracking START === -->
<script src="/js/ad-slot-view-tracking.js"></script>
<!-- === TTG Ad Slot View Tracking END === -->

  <script defer src="/prototype/js/stocking-prototype.js"></script>
  <script src="/prototype/assets/js/proto-popovers.js?v=proto_rm_2025_10_25" defer></script>
  <script>
    (function () {
      const TARGET_SELECTOR = '.filtration-card,.filtration-summary,.filter-setup-legacy,.filter-rows,.filter-row,.add-another-filter,.total-flow,.turnover,#filtration-summary,[data-card="filtration-summary"],#filtration-trigger';
      const purge = (root = document) => {
        root.querySelectorAll(TARGET_SELECTOR).forEach((node) => {
          node.remove();
        });
      };

      purge();

      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          mutation.addedNodes?.forEach((node) => {
            if (node.nodeType === 1) {
              purge(node);
            }
          });
        });
      });

      observer.observe(document.documentElement, { childList: true, subtree: true });
    })();
  </script>
  <script src="/js/footer-loader.js?v=1.4.8" defer></script>
  <div id="site-footer" data-footer-src="/footer.html?v=1.4.8"></div>
</body>
</html>
