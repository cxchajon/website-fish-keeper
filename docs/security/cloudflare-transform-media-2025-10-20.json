{
  "date_created": "2025-10-20T00:00:00Z",
  "rule_name": "Media Page CSP Override",
  "applies_to": ["thetankguide.com", "www.thetankguide.com"],
  "description": "Page-scoped response header override so /media.html can embed YouTube players without weakening the global policy.",
  "filter": {
    "field": "http.request.uri.path",
    "operator": "equals",
    "value": "/media.html"
  },
  "actions": [
    { "action": "set", "header": "Content-Security-Policy", "value": "default-src 'self'; script-src 'self' 'unsafe-inline' https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; img-src 'self' data: https://www.gstatic.com/recaptcha/ https://www.google.com/recaptcha/; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' https://formspree.io https://www.google.com/recaptcha/; frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; form-action 'self' https://formspree.io; base-uri 'self'; object-src 'none'; frame-ancestors 'self'; upgrade-insecure-requests" },
    { "action": "remove", "header": "X-Frame-Options" },
    { "action": "set", "header": "Referrer-Policy", "value": "strict-origin-when-cross-origin" },
    { "action": "set", "header": "X-Content-Type-Options", "value": "nosniff" },
    { "action": "set", "header": "Permissions-Policy", "value": "autoplay=(self \"https://www.youtube.com\"), fullscreen=(self \"https://www.youtube.com\")" }
  ]
}
