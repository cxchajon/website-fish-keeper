<!-- PROTOTYPE PAGE: do not copy to index.html without [index-override] + OWNER REVIEW -->
<!doctype html>
<html lang="en">
<head>
  <meta name="robots" content="noindex,nofollow">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Tank Guide â€” Prototype Home</title>
  <meta name="description" content="Smart fishkeeping guides, planning tools, and step-by-step checklists to set up, stock, and care for your aquarium." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css?v=1.0.9">
  <link rel="stylesheet" href="/css/prototype-home.css">
  <style id="prototype-home-inline">
    /* Scoped only to prototype page */
    .page--prototype-home {
      position: relative;
    }

    .page--prototype-home::before {
      content: "";
      position: absolute;
      top: 66px;
      left: 50%;
      transform: translateX(-50%);
      width: 100vw;
      height: clamp(240px, 38vh, 460px);
      background: linear-gradient(180deg,
          rgba(255, 255, 255, 0) 0px,
          rgba(255, 255, 255, 0) 8px,
          rgba(255, 255, 255, 0.42) 22%,
          rgba(255, 255, 255, 0.32) 40%,
          rgba(255, 255, 255, 0.12) 64%,
          rgba(255, 255, 255, 0) 100%);
      pointer-events: none;
      z-index: 0;
    }

    @media (max-width: 600px) {
      .page--prototype-home::before {
        height: clamp(280px, 44vh, 520px);
        background: linear-gradient(180deg,
            rgba(255, 255, 255, 0) 0px,
            rgba(255, 255, 255, 0) 8px,
            rgba(255, 255, 255, 0.44) 20%,
            rgba(255, 255, 255, 0.34) 38%,
            rgba(255, 255, 255, 0.14) 64%,
            rgba(255, 255, 255, 0) 100%);
      }
    }

    @media (min-width: 1024px) {
      .page--prototype-home::before {
        top: 66px;
        height: clamp(210px, 30vh, 360px);
        background: linear-gradient(180deg,
            rgba(255, 255, 255, 0) 0px,
            rgba(255, 255, 255, 0) 10px,
            rgba(255, 255, 255, 0.32) 18%,
            rgba(255, 255, 255, 0.22) 30%,
            rgba(255, 255, 255, 0.1) 56%,
            rgba(255, 255, 255, 0) 100%);
      }
    }

    .page--prototype-home .proto-home {
      position: relative;
      isolation: isolate;
      z-index: 1;
    }

    .page--prototype-home #site-nav,
    .page--prototype-home #global-nav {
      position: relative;
      z-index: 2;
    }

    .page--prototype-home .proto-home > .wrap {
      display: grid;
      gap: clamp(48px, 7vw, 88px);
      position: relative;
      z-index: 1;
    }

    .page--prototype-home .hero--prototype {
      position: relative;
      z-index: 1;
      padding: 28px 20px 38px;
      min-height: 100dvh;
      background:
        radial-gradient(1200px 800px at 75% -10%, #36c2cc 0%, rgba(54, 194, 204, 0) 60%),
        radial-gradient(1200px 900px at -10% 120%, #0077c7 0%, rgba(0, 119, 199, 0) 60%),
        linear-gradient(140deg, #0077c7 0%, #0b6ea6 40%, #0a4d87 100%);
    }

    .page--prototype-home .hero--prototype .wrap {
      max-width: 1080px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .page--prototype-home .hero-copy {
      max-width: 30rem;
      padding: 16px 0 14px;
      margin: 0;
    }

    .page--prototype-home .hero-copy .hero-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin: 0 0 6px 0;
      font-size: 1.4rem;
      font-weight: 800;
      letter-spacing: -0.01em;
      line-height: 1.1;
    }

    .page--prototype-home .hero-copy .hero-subline {
      margin: 0 0 4px 0;
      font-size: 1rem;
      font-weight: 400;
      letter-spacing: normal;
      color: rgba(255, 255, 255, 0.9);
    }

    .page--prototype-home .hero-copy .hero-subline strong {
      font-weight: 800;
      color: rgba(255, 255, 255, 0.98);
    }

    .page--prototype-home .hero-copy .hero-lede {
      margin: 6px 0 8px 0;
      font-size: 1.05rem;
      line-height: 1.35;
      color: rgba(255, 255, 255, 0.85);
      max-width: 42ch;
    }

    .page--prototype-home .hero-copy .how {
      margin: 0.35rem 0 0;
    }

    .page--prototype-home .hero-copy .how .how-trigger {
      all: unset;
      display: inline;
      cursor: pointer;
      font: inherit;
      font-size: 0.95rem;
      line-height: 1;
      color: rgba(255, 255, 255, 0.95);
      text-decoration: underline;
      text-underline-offset: 2px;
      transition: opacity 0.2s ease;
    }

    .page--prototype-home .hero-copy .how .how-trigger:hover {
      opacity: 0.9;
    }

    .page--prototype-home .hero-copy .how .how-trigger:focus-visible {
      outline: 2px solid currentColor;
      outline-offset: 2px;
    }

    @media (min-width: 768px) {
      .page--prototype-home .hero-copy {
        max-width: 40rem;
        padding: 24px 0 18px;
      }

      .page--prototype-home .hero-copy .hero-title {
        margin-bottom: 8px;
      }
    }

    .page--prototype-home .tools {
      display: grid;
      gap: clamp(24px, 4vw, 32px);
      max-width: 1100px;
      margin: clamp(16px, 2vw, 20px) auto 0;
      scroll-margin-top: clamp(80px, 12vw, 140px);
    }

    @media (min-width: 640px) {
      .page--prototype-home .tools {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1100px) {
      .page--prototype-home .tools {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .page--prototype-home .tool-card {
      position: relative;
      display: grid;
      gap: clamp(16px, 2.2vw, 24px);
      padding: clamp(24px, 4vw, 36px);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
      border: 1px solid rgba(255,255,255,0.16);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.20),
        0 10px 18px rgba(0,0,0,0.18),
        0 24px 40px rgba(0,0,0,0.22);
      contain: paint;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .page--prototype-home .tool-card::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(240px 160px at 18% 10%, rgba(255,255,255,.14) 0%, rgba(255,255,255,0) 70%),
        radial-gradient(260px 180px at 86% 14%, rgba(255,255,255,.08) 0%, rgba(255,255,255,0) 72%);
    }

    .page--prototype-home .tool-card h2 {
      margin: 0;
      font-size: clamp(1.5rem, 2.2vw, 1.875rem);
      font-weight: 700;
      letter-spacing: -0.01em;
      line-height: 1.2;
    }

    .page--prototype-home .tool-card p {
      margin: 0;
      line-height: 1.6;
    }

    .page--prototype-home .tool-card:hover,
    .page--prototype-home .tool-card:focus-within {
      transform: translateY(-4px);
      box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.24),
        0 18px 28px rgba(0, 0, 0, 0.24),
        0 36px 54px rgba(0, 0, 0, 0.28);
    }

    .page--prototype-home .btn-glossy {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-height: clamp(52px, 7vw, 76px);
      padding-inline: clamp(20px, 6vw, 36px);
      border-radius: 999px;
      border: 2px solid rgba(255,255,255,0.95);
      font-weight: 800;
      letter-spacing: 0.02em;
      text-decoration: none;
      color: #fff;
      background: linear-gradient(180deg, #49a5ff 0%, #1a66e9 100%);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.48),
        0 14px 26px rgba(6,42,77,0.22),
        0 6px 12px rgba(6,42,77,0.16);
      position: relative;
      overflow: hidden;
      contain: paint;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .page--prototype-home .btn-glossy::before {
      content: "";
      position: absolute;
      left: 6%;
      right: 12%;
      top: 14%;
      height: 52%;
      border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,0.74) 0%, rgba(255,255,255,0.22) 78%, rgba(255,255,255,0) 100%);
      pointer-events: none;
    }

    .page--prototype-home .btn-glossy > span {
      position: relative;
      z-index: 1;
      font-size: clamp(18px, 2.6vw, 28px);
      line-height: 1;
    }

    .page--prototype-home .btn-glossy:hover {
      transform: translateY(-1px);
    }

    .page--prototype-home .btn-glossy:active {
      transform: translateY(1px);
      box-shadow:
        inset 0 2px 6px rgba(0,0,0,0.18),
        0 8px 14px rgba(6,42,77,0.20),
        0 3px 8px rgba(6,42,77,0.12);
    }

    .page--prototype-home .btn-glossy:focus-visible {
      outline: 3px solid rgba(255, 255, 255, 0.85);
      outline-offset: 4px;
    }

    .page--prototype-home .proto-section {
      max-width: min(62rem, 92vw);
      margin-inline: auto;
      display: grid;
      gap: clamp(16px, 3vw, 24px);
    }

    .page--prototype-home .proto-section h2 {
      margin: 0;
      font-size: clamp(1.75rem, 3vw, 2.25rem);
      line-height: 1.25;
    }

    .page--prototype-home .proto-section p {
      margin: 0;
      line-height: 1.7;
    }

    .page--prototype-home .deep-blurb {
      padding: clamp(32px, 6vw, 64px) clamp(20px, 4vw, 64px);
    }

    .page--prototype-home .deep-blurb__copy {
      max-width: 46rem;
      margin: 0 auto;
      line-height: 1.6;
      text-align: center;
    }

    .page--prototype-home .how-it-works-overlay[hidden] {
      display: none;
    }

    .page--prototype-home .how-it-works-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(20px, 4vw, 40px);
      background: rgba(8, 12, 20, 0.68);
      backdrop-filter: blur(6px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1200;
    }

    .page--prototype-home .how-it-works-overlay.is-visible {
      opacity: 1;
      pointer-events: auto;
    }

    .page--prototype-home.modal-open .proto-home {
      filter: blur(6px);
      transition: filter 0.3s ease;
    }

    .page--prototype-home .how-it-works-modal {
      display: grid;
      gap: clamp(16px, 3vw, 24px);
      padding: clamp(24px, 4vw, 36px);
      border-radius: 24px;
      background: rgba(25, 35, 52, 0.82);
      box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.18),
        0 20px 60px rgba(0, 0, 0, 0.35);
      color: rgba(255, 255, 255, 0.96);
      max-width: min(520px, 100%);
      width: 100%;
      border: 1px solid rgba(255, 255, 255, 0.16);
      background-image: linear-gradient(145deg, rgba(45, 60, 92, 0.92), rgba(16, 22, 34, 0.75));
    }

    .page--prototype-home .how-it-works-modal__header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .page--prototype-home .how-it-works-modal__header h2 {
      margin: 0;
      font-size: clamp(1.5rem, 2.6vw, 2rem);
      letter-spacing: -0.01em;
    }

    .page--prototype-home .how-it-works-modal__close {
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.25);
      color: rgba(255, 255, 255, 0.9);
      border-radius: 999px;
      width: 40px;
      height: 40px;
      font-size: 1.5rem;
      line-height: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s ease, background 0.2s ease;
    }

    .page--prototype-home .how-it-works-modal__close:hover,
    .page--prototype-home .how-it-works-modal__close:focus-visible {
      background: rgba(255, 255, 255, 0.24);
      transform: translateY(-1px);
    }

    .page--prototype-home .how-it-works-modal__body {
      display: grid;
      gap: clamp(12px, 2.6vw, 18px);
    }

    .page--prototype-home .how-it-works-modal__body p {
      margin: 0;
      line-height: 1.6;
    }

    .page--prototype-home .how-it-works-modal__body ol {
      margin: 0;
      padding-left: 1.25rem;
      display: grid;
      gap: 0.75rem;
    }

    .page--prototype-home .how-it-works-modal__body li {
      line-height: 1.6;
    }

    .page--prototype-home .how-it-works-modal__cta {
      font-weight: 600;
      color: rgba(255, 255, 255, 0.95);
    }

    .page--prototype-home .how-it-works-modal__footer {
      display: flex;
      justify-content: flex-end;
    }

    body.prototype-page .current-stock-card,
    body.prototype-page #current-stock {
      position: relative;
      overflow: visible;
    }

    /* Info button */
    body.prototype-page .info-btn {
      inline-size: 1.5rem;
      block-size: 1.5rem;
      border-radius: 50%;
      border: 1px solid var(--ink-20, #7aa0c8);
      background: transparent;
      color: inherit;
      font: 600 0.9rem/1 system-ui;
      display: inline-grid;
      place-items: center;
      margin-inline-start: 0.4rem;
      cursor: pointer;
    }

    /* Popover anchored tightly to the button */
    body.prototype-page .info-popover {
      position: absolute;
      top: calc(100% + 0.5rem);
      right: 0.5rem;
      z-index: 999;
      max-inline-size: 22rem;
      padding: 1rem 1.2rem;
      border-radius: 0.75rem;
      border: 1px solid var(--ink-20, #274a63);
      background: rgba(14, 39, 56, 0.97);
      color: var(--ink-95, #eef6ff);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.35);
    }

    body.prototype-page .info-popover[hidden] {
      display: none;
    }

    body.prototype-page .info-popover__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.4rem;
    }

    body.prototype-page .info-popover__close {
      background: none;
      border: none;
      color: inherit;
      font-size: 1.2rem;
      line-height: 1;
      cursor: pointer;
    }

    body.prototype-page .info-popover ul {
      margin: 0;
      padding-left: 1.1rem;
      font-size: 0.92rem;
      line-height: 1.45;
    }

    @media (prefers-reduced-motion: reduce) {
      .page--prototype-home .tool-card,
      .page--prototype-home .btn-glossy,
      .page--prototype-home .how-it-works-overlay,
      .page--prototype-home .how-it-works-modal {
        transition: none;
        transform: none !important;
      }
    }

  </style>
</head>
<body class="page--prototype-home prototype-page">
  <!-- NAV (global include) -->
  <div id="site-nav" data-src="/nav.html"></div>

  <main class="proto-home">
    <div class="wrap">
      <!-- HERO (prototype-only, cloned from live) -->
      <section class="hero hero--prototype">
        <div class="wrap">
          <div class="hero-copy">
            <h1 class="hero-title">Fishkeeping Guides &amp; Tools â€” The Tank Guide</h1>
            <p class="hero-subline">a product of <strong>FishKeepingLifeCo</strong></p>
            <p class="hero-lede">
              Smart fishkeeping guides, planning tools, and step-by-step checklists to set up, stock, and care for your aquarium.
            </p>
            <p class="how">
              <button type="button" id="how-it-works-button" class="how-trigger" aria-expanded="false"
                aria-controls="how-it-works-modal">How it works</button>
            </p>
          </div>
        </div>
      </section>

      <!-- CARDS -->
      <div class="tools" id="how-it-works">
        <section class="card tool-card">
          <h2>Stocking Advisor</h2>
          <p>Smart stocking made simple â€” plan a thriving community with confidence.</p>
          <a class="btn-glossy" href="/stocking.html" aria-label="Plan my aquarium stocking list with the Stocking Advisor"><span>Plan My Stocking List</span></a>
        </section>

        <section class="card tool-card">
          <h2>Gear</h2>
          <p>The gear you need, matched to your tank and goals.</p>
          <a class="btn-glossy" href="/gear/" aria-label="Browse the aquarium Gear Guide"><span>Browse the Gear Guide</span></a>
        </section>

        <section class="card tool-card">
          <h2>Cycling Coach</h2>
          <p>Master the nitrogen cycle with step-by-step guidance.</p>
          <a class="btn-glossy" href="/params.html" aria-label="Start the Cycling Coach for step-by-step nitrogen cycling"><span>Start the Cycling Coach</span></a>
        </section>

        <section class="card tool-card">
          <h2>Media</h2>
          <p>Watch â€¢ Read â€¢ Explore â€” videos and blogs for every aquarist.</p>
          <a class="btn-glossy" href="/media.html" aria-label="Explore videos and articles in the Media Hub"><span>Explore the Media Hub</span></a>
        </section>

        <section class="card tool-card">
          <h2>About</h2>
          <p>Learn who we are, our approach to guides and tools, and whatâ€™s next for The Tank Guide.</p>
          <a class="btn-glossy" href="/about.html" aria-label="Learn more about The Tank Guide"><span>Learn more</span></a>
        </section>

        <section class="card tool-card">
          <h2>Contact</h2>
          <p>Questions, ideas, or spot a logic issue? Reach out with feedback, recommend fish or gear to review, or share your insights.</p>
          <a class="btn-glossy" href="/contact-feedback.html" aria-label="Contact The Tank Guide team and share feedback"><span>Contact &amp; Feedback</span></a>
        </section>
      </div>

      <!-- LONG-FORM COPY (same background; no dividers) -->
      <section class="section proto-section" id="aquarium-science">
        <h2>Aquarium Science, Simplified for Everyone</h2>
        <p>Welcome to The Tank Guide, where we make the science of aquariums simple, beautiful, and accessible for everyone. We know that starting your first fish tank can feel like a deep dive into a world of complex chemistry and conflicting advice. Our mission, powered by FishKeepingLifeCo, is to be the clear, calm voice that guides you from confusion to confidence.</p>
      </section>

      <section class="section proto-section" id="nitrogen-cycle">
        <h2>Master the Foundation: Understanding the Nitrogen Cycle</h2>
        <p>At the heart of every stable aquarium is one crucial process: the nitrogen cycle. Itâ€™s the invisible engine that turns fish waste into harmless nitrates, creating a safe environment for your aquatic life. Instead of just telling you about it, weâ€™ve built the Cycling Coachâ€”an interactive tool that lets you track your tankâ€™s progress and understand each stage. This isnâ€™t just data; itâ€™s the foundation of responsible fishkeeping, and weâ€™re here to walk you through every step.</p>
      </section>

      <section class="section proto-section" id="stocking-advisor">
        <h2>Build a Balanced Community with Our Stocking Advisor</h2>
        <p>Once your tank is cycled and ready, the real fun begins: choosing your fish. But how many can you add? Will they get along? A healthy tank is a balanced ecosystem, not just a collection of pretty fish. Thatâ€™s why we developed our Stocking Advisor. It goes beyond simple â€˜one inch of fish per gallonâ€™ rules, using logic based on bioload, behavior, and filtration capacity. This tool, born from our own research and testing, helps you build a peaceful and thriving underwater community without the stress of guesswork. Use it to test your ideas in real time and plan a tank thatâ€™s both beautiful and sustainable.</p>
        <div class="current-stock-card" id="current-stock" aria-live="polite">
          <h3 class="card-title">
            Current Stock
            <button
              id="stocking-checklist-btn"
              class="info-btn"
              type="button"
              aria-expanded="false"
              aria-label="View Responsible Stocking Checklist"
              aria-controls="stocking-checklist-pop"
            >i</button>
          </h3>

          <!-- Popover content -->
          <div
            id="stocking-checklist-pop"
            class="info-popover"
            role="dialog"
            aria-labelledby="stocking-checklist-title"
            aria-modal="false"
            hidden
          >
            <div class="info-popover__header">
              <strong id="stocking-checklist-title">Responsible Stocking Checklist</strong>
              <button class="info-popover__close" type="button" aria-label="Close">Ã—</button>
            </div>
            <ul>
              <li>Verify your nitrogen cycle is stable with zero ammonia and nitrite before introducing new species.</li>
              <li>Match species by temperature, pH, and hardness tolerances, leaning toward the overlap rather than the extremes.</li>
              <li>Stage livestock additions over several weeks so your biofilter adapts gradually.</li>
              <li>Supplement mechanical filtration with live plants or seeded media to buffer bioload spikes.</li>
              <li>Keep a log of maintenance tasks, feeding routines, and observed behavior shifts to inform future adjustments.</li>
            </ul>
          </div>

          <p class="card-subtitle">Your selected fish and inverts appear here. No stock yet. Add species to begin.</p>
        </div>
      </section>

      <section class="section proto-section" id="learn-with-us">
        <h2>Learn with Us: From Our Tank to Yours</h2>
        <p>Everything we teach is backed by real-world experience. Our guides and articles are directly informed by our own ongoing research and testing, where we document everything from fertilizer dosing to fish behavior. You can follow our journey on our Media Hub, where we share our logs, videos, and insights. This is science in action, not just in theory.</p>
        <p>We believe that a successful aquarium is one of the most rewarding experiences a family can share. Itâ€™s a living piece of art and a constant lesson in biology. With the right knowledge and the right tools, you can create a stunning underwater world that lasts for years to come. Your journey starts here.</p>
      </section>

      <div class="spacer" aria-hidden="true"></div>
    </div>
  </main>

  <div class="how-it-works-overlay" data-how-it-works-overlay hidden aria-hidden="true">
    <div class="how-it-works-modal" id="how-it-works-modal" role="dialog" aria-modal="true"
      aria-labelledby="how-it-works-title" aria-describedby="how-it-works-description" tabindex="-1">
      <header class="how-it-works-modal__header">
        <h2 id="how-it-works-title">How The Tank Guide Works</h2>
        <button type="button" class="how-it-works-modal__close" data-close-modal aria-label="Close How it Works dialog">
          <span aria-hidden="true">&times;</span>
        </button>
      </header>
      <div class="how-it-works-modal__body" id="how-it-works-description">
        <p>The prototype home highlights the core experiences that guide you from tank setup to long-term care.</p>
        <ol>
          <li><strong>Start with the Hero tools</strong> â€” jump into stocking, gear, or cycling workflows matched to your tank.</li>
          <li><strong>Follow guided checklists</strong> that adapt to your experience level and simplify water science.</li>
          <li><strong>Stay supported</strong> with media hubs, research logs, and contact options when you need a deeper dive.</li>
        </ol>
        <p class="how-it-works-modal__cta">Ready to explore? Launch any tool to see the full experience.</p>
      </div>
      <div class="how-it-works-modal__footer">
        <button type="button" class="btn-glossy" data-close-modal>Close</button>
      </div>
    </div>
  </div>


  <!-- Bottom blurb (sits on dark background) -->
  <section class="deep-blurb" aria-labelledby="deep-blurb-title">
    <div class="container">
      <h2 id="deep-blurb-title" class="visually-hidden">About The Tank Guide</h2>
      <p class="deep-blurb__copy">
        The Tank Guide simplifies aquarium setup and fishkeeping confidence.
        Plan, cycle, stock, and maintain your thriving planted aquarium or
        community tank. (FKLCo)
      </p>
    </div>
  </section>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('stocking-checklist-btn');
    const pop = document.getElementById('stocking-checklist-pop');
    const closeBtn = pop?.querySelector('.info-popover__close');
    if (!btn || !pop || !closeBtn) return;

    const card = btn.closest('.current-stock-card') || btn.closest('#current-stock');
    card.style.position = 'relative';
    card.style.overflow = 'visible';

    const open = () => {
      const rect = btn.getBoundingClientRect();
      const offset = rect.bottom + window.scrollY + 8;
      pop.style.top = `${btn.offsetTop + btn.offsetHeight + 8}px`;
      pop.style.right = `8px`;
      pop.hidden = false;
      btn.setAttribute('aria-expanded', 'true');
      closeBtn.focus();
    };

    const close = () => {
      pop.hidden = true;
      btn.setAttribute('aria-expanded', 'false');
      btn.focus();
    };

    btn.addEventListener('click', e => {
      e.preventDefault();
      pop.hidden ? open() : close();
    });
    closeBtn.addEventListener('click', close);
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && !pop.hidden) close();
    });
    document.addEventListener('click', e => {
      if (!pop.hidden && !pop.contains(e.target) && e.target !== btn) close();
    });
  });
  </script>

  <script>
  (function () {
    const page = document.querySelector('.page--prototype-home');
    if (!page) return;

    const openButton = page.querySelector('#how-it-works-button');
    const overlay = page.querySelector('[data-how-it-works-overlay]');
    const modal = overlay ? overlay.querySelector('.how-it-works-modal') : null;
    const closeButtons = overlay ? Array.from(overlay.querySelectorAll('[data-close-modal]')) : [];

    const focusableSelectors = [
      'a[href]:not([tabindex="-1"])',
      'button:not([disabled]):not([tabindex="-1"])',
      'textarea:not([disabled])',
      'input[type="text"]:not([disabled])',
      'input[type="radio"]:not([disabled])',
      'input[type="checkbox"]:not([disabled])',
      'select:not([disabled])',
      '[tabindex]:not([tabindex="-1"])'
    ].join(',');

    if (!openButton || !overlay || !modal) {
      return;
    }

    let lastFocusedElement = null;

    const setAriaState = (expanded) => {
      openButton.setAttribute('aria-expanded', String(expanded));
      overlay.setAttribute('aria-hidden', String(!expanded));
    };

    const getFocusableItems = () => Array.from(modal.querySelectorAll(focusableSelectors));

    const focusFirstElement = () => {
      const focusableItems = getFocusableItems();
      const target = focusableItems.length ? focusableItems[0] : modal;
      target.focus({ preventScroll: true });
    };

    const handleKeydown = (event) => {
      if (event.key === 'Escape') {
        event.preventDefault();
        closeModal();
        return;
      }

      if (event.key !== 'Tab') {
        return;
      }

      const focusableItems = getFocusableItems();
      if (!focusableItems.length) {
        event.preventDefault();
        modal.focus({ preventScroll: true });
        return;
      }

      const first = focusableItems[0];
      const last = focusableItems[focusableItems.length - 1];

      if (!event.shiftKey && document.activeElement === last) {
        event.preventDefault();
        first.focus();
      } else if (event.shiftKey && document.activeElement === first) {
        event.preventDefault();
        last.focus();
      }
    };

    const closeModal = () => {
      if (overlay.hidden) return;

      overlay.classList.remove('is-visible');

      const finalizeClose = () => {
        overlay.hidden = true;
        overlay.removeEventListener('transitionend', finalizeClose);
      };

      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        finalizeClose();
      } else {
        overlay.addEventListener('transitionend', finalizeClose, { once: true });
        window.setTimeout(finalizeClose, 350);
      }

      page.classList.remove('modal-open');
      document.removeEventListener('keydown', handleKeydown, true);
      setAriaState(false);

      if (lastFocusedElement) {
        lastFocusedElement.focus({ preventScroll: true });
      }
    };

    const openModal = () => {
      if (!overlay.hidden) return;

      lastFocusedElement = document.activeElement;
      overlay.hidden = false;
      window.requestAnimationFrame(() => {
        overlay.classList.add('is-visible');
      });

      page.classList.add('modal-open');
      document.addEventListener('keydown', handleKeydown, true);
      setAriaState(true);

      window.setTimeout(focusFirstElement, 50);
    };

    openButton.addEventListener('click', openModal);

    overlay.addEventListener('click', (event) => {
      if (event.target === overlay) {
        closeModal();
      }
    });

    closeButtons.forEach((button) => {
      button.addEventListener('click', closeModal);
    });
  })();
  </script>

  <!-- include loaders already used on the main site -->
  <script src="/js/nav.js?v=1.4.7" defer></script>
  <script src="/js/footer-loader.js?v=1.4.7" defer></script>

  <!-- FOOTER (global include) -->
  <div id="site-footer" data-src="/footer.html?v=1.4.7" data-footer-src="/footer.html?v=1.4.7"></div>

</body>
</html>
