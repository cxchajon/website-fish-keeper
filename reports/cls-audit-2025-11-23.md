# COMPREHENSIVE SITE-WIDE LAYOUT SHIFT (CLS) AUDIT

**Site:** thetankguide.com
**Date:** November 23, 2025
**Total HTML Files Analyzed:** 36

---

## CRITICAL - Fix Immediately (P0)

### Page: gear/index.html
- **Issue:** 2 AdSense slots without min-height CSS
- **Ad Slots:** 7692943403, 1762971638
- **CSS Problem:** Uses `main.bundle.css` which only applies min-height to `body.prototype-stock-page` - body class is `theme-dark`
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Impact:** **HIGH CLS** - ads will cause layout shift on load
- **Recommended Fix:** Add global `.ttg-ad-slot` min-height to main.bundle.css or add inline styles
- **Priority:** P0

### Page: cycling-coach/index.html
- **Issue:** 2 AdSense slots without min-height CSS
- **Ad Slots:** 8136808291, 5754828160
- **CSS Problem:** Uses `main.bundle.css` which only applies min-height to `body.prototype-stock-page` - body class is `page--cycling-coach`
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** Interactive form tool with dynamic state changes
- **Impact:** **HIGH CLS** - ads + form interactions cause shifts
- **Recommended Fix:** Add global `.ttg-ad-slot` min-height to main.bundle.css
- **Priority:** P0

### Page: feature-your-tank.html
- **Issue:** 1 AdSense slot, Cloudinary widget creates dynamic iframes
- **Ad Slot:** 7540927750
- **CSS Problem:** Has inline min-height: 0 (line 245) which OVERRIDES any global fix
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** Image upload widget creates unpredictable layout shifts
- **Impact:** **HIGH CLS** - multiple dynamic elements
- **Recommended Fix:** Remove `min-height: 0` override, set proper min-height for Cloudinary container
- **Priority:** P0

### Page: pages/university.html
- **Issue:** 4 AdSense slots
- **Ad Slots:** 2756710212, 4602491969, 6295558025, 1234803039
- **CSS:** Uses `style.css` (has min-height: 280px) ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** Potentially expandable study card sections
- **Impact:** **MEDIUM CLS** - CSS fix exists but 4 slots means more potential shifts
- **Recommended Fix:** Verify `contain: layout` is applied, check collapsible sections
- **Priority:** P0

---

## HIGH PRIORITY - Fix Soon (P1)

### Page: blogs/index.html
- **Issue:** 2 AdSense slots
- **Ad Slots:** 8429932627, 4645889847
- **CSS:** Uses `style.css` (has min-height: 280px) ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** Blog grid with potentially lazy-loaded cards
- **Impact:** **MEDIUM CLS** - CSS fix exists but missing `contain: layout`
- **Recommended Fix:** Add `contain: layout` to style.css for .ttg-ad-slot
- **Priority:** P1

### Page: media.html
- **Issue:** 2 AdSense slots, 1 image without dimensions
- **Ad Slots:** 6411910426, 6497764235
- **CSS:** Uses `style.css` (has min-height: 280px) ✓
- **Images Missing Dimensions:** `/assets/img/fishkeepinglifeco-storefront.webp` (line 357)
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** YouTube embed with lazy loading
- **Impact:** **MEDIUM CLS** - image without dimensions + lazy iframe
- **Recommended Fix:** Add width/height to storefront image, add `contain: layout`
- **Priority:** P1

### Page: assistant.html
- **Issue:** 2 AdSense slots, dynamic AI response content
- **Ad Slots:** 8930237876, 9864045598
- **CSS:** Has inline min-height: 280px ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Additional:** AI responses create unpredictable content expansion
- **Impact:** **MEDIUM-HIGH CLS** - dynamic content expansion
- **Recommended Fix:** Add `contain: layout`, reserve space for response container
- **Priority:** P1

### Page: pages/community-video-picks.html
- **Issue:** 2 images without dimensions
- **Images Missing Dimensions:**
  - Line 131: `https://img.youtube.com/vi/zX3wGQpC4eE/hqdefault.jpg`
  - Line 155: `https://img.youtube.com/vi/QbPxRZqd4MI/hqdefault.jpg`
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Impact:** **MEDIUM CLS** - images will shift layout when loaded
- **Recommended Fix:** Add `width="480" height="360"` to YouTube thumbnails
- **Priority:** P1

---

## MEDIUM PRIORITY - Monitor (P2)

### Page: stocking-advisor.html
- **Issue:** 3 AdSense slots (known issue - marked as in progress)
- **Ad Slots:** 8419879326, 5996977454, 9758352395
- **CSS:** Uses `app.bundle.css` which has global fix with `contain: layout` ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Status:** Fix already applied via app.bundle.css
- **Impact:** **LOW CLS** - global fix in place
- **Priority:** P2 (monitor)

### Page: about.html
- **Issue:** 1 AdSense slot
- **Ad Slot:** 7675114538
- **CSS:** Has inline min-height: 280px ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Impact:** **LOW CLS** - inline fix applied
- **Recommended Fix:** Add `contain: layout`
- **Priority:** P2

### Page: index.html (homepage)
- **Issue:** No AdSense slots, dynamic footer/nav
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Nav Loader:** Yes (`/js/nav.js`)
- **Impact:** **LOW CLS** - only footer/nav loading
- **Recommended Fix:** Ensure #site-footer has min-height in style.css
- **Priority:** P2

### Page: journal-dashboard.html
- **Issue:** Possible AdSense slots, real-time data updates
- **Footer Loader:** Yes
- **Additional:** Dashboard with dynamic charts/data
- **Impact:** **MEDIUM CLS** - frequent data updates
- **Recommended Fix:** Use `contain: layout` on data containers, reserve space for charts
- **Priority:** P2

### Page: cookie-settings.html
- **Issue:** Toggle switch interactions
- **Footer Loader:** Yes
- **Impact:** **LOW CLS** - toggle switches can cause minor reflow
- **Priority:** P2

### Page: contact-feedback.html
- **Issue:** Form validation states
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Impact:** **LOW CLS** - form validation can cause minor shifts
- **Priority:** P2

---

## LOW PRIORITY - Optimization (P3)

### Page: store.html
- **Issue:** Images have proper dimensions
- **Images:** 5+ images with width/height (1200x1600px book covers) ✓
- **Footer Loader:** Yes (`/js/footer-loader.js`)
- **Impact:** **NONE** - properly sized
- **Priority:** P3

### Page: journal.html
- **Issue:** Legalpad styling with proper font preload
- **Footer Loader:** Yes
- **Fonts:** Patrick Hand, Kalam (properly preloaded)
- **Impact:** **NONE** - fixed layout
- **Priority:** P3

### Blog articles (blogs/blackbeard/, blogs/purigen/, blogs/nitrogen-cycle/, etc.)
- **Issue:** Some images in blog content may be missing dimensions
- **Images Identified:**
  - `blogs/blackbeard/index.html`: 4 images (lines 206, 235, 242, 266) - need to verify dimensions
  - `blogs/purigen/index.html`: 3 images (lines 153, 212, 218) - some missing dimensions
  - `blogs/nitrogen-cycle/index.html`: 1 image with dimensions ✓
- **Impact:** **LOW CLS** - static article content
- **Priority:** P3

---

## CLEAN - No Issues Found ✓

- **privacy-legal.html** - No ads, static legal content
- **terms.html** - No ads, static legal content
- **copyright-dmca.html** - No ads, static legal content
- **404.html** - No ads, simple error page

---

## GLOBAL FIX RECOMMENDATION

### Option B: Add Global CSS to style.css (RECOMMENDED)

The most efficient approach is to add the global fix to `/css/style.css` since it's used by most pages:

```css
/* Add to css/style.css - Global AdSense layout shift fix */
.ttg-ad-slot {
  min-height: 250px;
  contain: layout;
}

.ttg-ad-slot:not(.ttg-ad-slot--empty) {
  min-height: 0;
}

#site-footer {
  min-height: 200px;
  contain: content;
}
```

### Additional Fix: Update main.bundle.css

Remove the `body.prototype-stock-page` restriction in main.bundle.css to apply min-height globally:

```css
/* Change from: */
body.prototype-stock-page .ttg-ad-slot {
  min-height: 280px;
}

/* To: */
.ttg-ad-slot {
  min-height: 280px;
  contain: layout;
}
```

---

## AD SLOT INVENTORY

| Page | Ad Slots | Slot IDs | Min-Height CSS | Status |
|------|----------|----------|----------------|--------|
| stocking-advisor.html | 3 | 8419879326, 5996977454, 9758352395 | ✓ app.bundle.css | Fixed |
| gear/index.html | 2 | 7692943403, 1762971638 | ✗ Missing | **CRITICAL** |
| cycling-coach/index.html | 2 | 8136808291, 5754828160 | ✗ Missing | **CRITICAL** |
| pages/university.html | 4 | 2756710212, 4602491969, 6295558025, 1234803039 | ✓ style.css | Monitor |
| blogs/index.html | 2 | 8429932627, 4645889847 | ✓ style.css | Monitor |
| media.html | 2 | 6411910426, 6497764235 | ✓ style.css | Monitor |
| assistant.html | 2 | 8930237876, 9864045598 | ✓ inline | Monitor |
| about.html | 1 | 7675114538 | ✓ inline | Good |
| feature-your-tank.html | 1 | 7540927750 | ✗ Override to 0 | **CRITICAL** |

**Total AdSense Slots:** 19 across 9 pages

---

## IMAGES WITHOUT DIMENSIONS

| Page | Image | Issue |
|------|-------|-------|
| media.html:357 | `/assets/img/fishkeepinglifeco-storefront.webp` | Missing width/height |
| pages/community-video-picks.html:131 | YouTube thumbnail | Missing width/height |
| pages/community-video-picks.html:155 | YouTube thumbnail | Missing width/height |
| blogs/blackbeard/index.html | 4 images | Verify dimensions in `<img>` tags |
| blogs/purigen/index.html | 2 Amazon images | Missing width/height on lazy-loaded |

---

## PREVENTION CHECKLIST

For future pages:
- [ ] Reserve space for AdSense slots (`min-height: 250px`)
- [ ] Add `contain: layout` to ad containers
- [ ] Add width and height to ALL `<img>` tags
- [ ] Set min-height on #site-footer (200px minimum)
- [ ] Set min-height on dynamic content containers
- [ ] Use `font-display: swap` for web fonts
- [ ] Add explicit dimensions to YouTube thumbnails (480x360 for hqdefault)
- [ ] Reserve space for Cloudinary upload widgets
- [ ] Test CLS score in Chrome DevTools before deploying

---

## TESTING PLAN

### For each flagged page:

1. **Open Chrome DevTools** → Performance tab
2. **Throttle network** to "Slow 3G"
3. **Check "Screenshots"** option
4. **Click Record** and refresh the page
5. **Look for Layout Shift events** in the timeline (purple sections)
6. **Check CLS metric** in the summary

### Target CLS Scores:
- **Good:** < 0.1
- **Needs Improvement:** 0.1 - 0.25
- **Poor:** > 0.25

### Specific Page Tests:

**gear/index.html:**
```
1. Open https://thetankguide.com/gear/
2. Network: Slow 3G
3. Watch for ad slot expansion
4. Expected shift: ~50-100px per ad (HIGH)
```

**cycling-coach/index.html:**
```
1. Open https://thetankguide.com/cycling-coach/
2. Network: Slow 3G
3. Watch for ad slot + form expansion
4. Expected shift: ~50-100px per ad + form states (HIGH)
```

**feature-your-tank.html:**
```
1. Open https://thetankguide.com/feature-your-tank.html
2. Test image upload flow
3. Watch for Cloudinary widget iframe creation
4. Expected shift: Multiple shifts from widget (HIGH)
```

---

## SUMMARY

### Immediate Action Required (P0):
1. **gear/index.html** - Add min-height to main.bundle.css or inline
2. **cycling-coach/index.html** - Add min-height to main.bundle.css
3. **feature-your-tank.html** - Remove min-height: 0 override
4. **pages/university.html** - Add contain: layout

### Quick Wins:
- Add `contain: layout` to all .ttg-ad-slot rules across CSS files
- Add #site-footer min-height to style.css and main.bundle.css
- Fix 3 images without dimensions

### Best Long-Term Solution:
Update main.bundle.css to remove the `body.prototype-stock-page` restriction so all pages get the global fix automatically.
